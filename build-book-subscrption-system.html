<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<link rel="stylesheet" type="text/css" href="css/CustomSetting.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🛤️&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>

  <title>我的第一个全栈项目：Book Subscrption System&nbsp;|&nbsp;Jingtian的博客</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="我的第一个全栈项目：Book Subscrption System">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧐&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🛤️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐣&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="tags.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🔖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Tags</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="posts.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📄&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Posts</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="projects.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📁&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Projects</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="discussion.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🗣️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Discusion</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧐&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">我的第一个全栈项目：Book Subscrption System</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Mar 18, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--yellow">
            <a href="tag/教程.html">教程</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/项目.html">项目</a>
          </span>
        
      </div>
    
  </header>
    <div id="content-html"></div>
  <article id="https://www.notion.so/9907d22db3a8472685917d1cddde49cd" class="PageRoot"><ul id="https://www.notion.so/884b9864ff544075b54052026201c77b" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/ce8d5c4a68524bacaaf88a5fcd58fae5"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">开场问题篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/943b33844c1b4fab864e5b2026c3e0d1"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Debug与优化篇</span></span></div></a></li></ul><h2 id="https://www.notion.so/ce8d5c4a68524bacaaf88a5fcd58fae5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ce8d5c4a68524bacaaf88a5fcd58fae5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">开场问题篇</span></span></h2><div id="https://www.notion.so/d083e4c3745a4a7a8cf63ad71390df29" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">为什么做这个？</strong></span></span></p></div><div id="https://www.notion.so/c0f113bd7bdd4b3a9762c0d20c764415" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">研一第一学期我选了一门COMS E6156云计算的课，要做一个全栈项目，并把它上传到云上。因为图书订阅系统所需要的微服务比较简单（即：用户，图书，订单），所以我们选择最后做这个。但是因为时间比较紧张，我们实际上是从2022/12/17开始做的，所以到了ddl的那天2022/12/23，真正在做也就是一周内高强度搞完的。</span></span></p></div><div id="https://www.notion.so/7ce0552028c845d08e434e1b70d84929" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如何短时间做一个版本出来？</strong></span></span></p></div><div id="https://www.notion.so/5c1a6093e8424e29878a739effa0af2d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首先是确定用什么技术：FastAPI的框架比Flask还简单，那肯定是用FastAPI做比较快了；前端用我稍微熟悉一点的React。</span></span></p></div><div id="https://www.notion.so/10fe71febe104217a332c49b7c12c15c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其次是如何使用完全不熟悉的FastAPI框架：查找已有的符合要求的demo，这样会比直接看文档更适合新手。之前的参考资料在</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/Iris1e27/FastAPI-demo-project">这里</a></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/f28f2eab9ef246daa64ced483e438fd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ddl结束时候提交的版本？</strong></span></span></p></div><div id="https://www.notion.so/afc1d29d5e3f45c4be400de38d646690" class="Bookmark"><a href="https://github.com/Iris1e27/book-subscription-system/tree/31d23f2da1e4c9e74a6daffacf5bb4363424b46b"><h5 class="Bookmark__Title">GitHub - Iris1e27/book-subscription-system at 31d23f2da1e4c9e74a6daffacf5bb4363424b46b</h5><p class="Bookmark__Desc">A cloud full stack web app for course COMS E6156. Contribute to Iris1e27/book-subscription-system development by creating an account on GitHub.</p><p class="Bookmark__Link">https://github.com/Iris1e27/book-subscription-system/tree/31d23f2da1e4c9e74a6daffacf5bb4363424b46b</p></a></div><div id="https://www.notion.so/4135bf6ca7144b879fb6f6ca2ea11f74" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">为什么继续做了？</strong></span></span></p></div><div id="https://www.notion.so/143aa3111c284f16bca2602063905d99" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">交上去的版本实际上并没有实现成功的上传aws的一些功能，那个版本有很多问题，所以我现在有了时间，并且因为要准备面试的项目，打算把bug改一改，代码优化一下。</span></span></p></div><h2 id="https://www.notion.so/943b33844c1b4fab864e5b2026c3e0d1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/943b33844c1b4fab864e5b2026c3e0d1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Debug与优化篇</span></span></h2><div id="https://www.notion.so/04e50dad44a5449ebfc9d229945ffef8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1）当我们把前端打包（npm run build）上传到S3的时候，发现之前的路由都失效了。</span></span></p></div><div id="https://www.notion.so/06eddd3f03424dda8f27668058b6d733" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首先是&lt;BrowserRouter&gt;路由：需要改成&lt;HashRouter&gt;</span></span></p></div><details id="https://www.notion.so/14c6bd3541684d808e1a7a5241582355" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">问chatgpt：我用aws的s3托管我的网站，应该用&lt;HashRouter&gt;还是&lt;BrowserRouter&gt;</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/c5ac86fbded147c1a96d5a210267af6e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果你的AWS S3托管的网站</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">没有使用自定义域名或SSL证书</strong></span><span class="SemanticString">，那么建议你使用&lt;HashRouter&gt;来实现路由，因为它不需要Web服务器支持HTML5的History API。相反，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">&lt;HashRouter&gt;使用URL的哈希部分来表示路由，因此即使AWS S3托管的网站使用默认的S3托管域名，也可以实现客户端路由</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/3f120ecaee884902bcdb066e4c93e960" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">但是，如果你的AWS S3托管的网站</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">使用自定义域名或SSL证书</strong></span><span class="SemanticString">，那么你可以使用&lt;BrowserRouter&gt;来实现路由。&lt;BrowserRouter&gt;使用HTML5的History API来表示路由，这通常需要Web服务器支持HTML5的History API。但是，AWS S3支持将自定义域名和SSL证书映射到S3桶，这样你就可以在AWS S3上使用自定义域名和SSL证书来实现客户端路由。</span></span></p></div><div id="https://www.notion.so/e67c72e4042948819fa4e1a080bed898" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">综上所述，建议你在选择使用&lt;HashRouter&gt;还是&lt;BrowserRouter&gt;时，考虑你的AWS S3托管的网站是否使用自定义域名或SSL证书，以及Web服务器对HTML5的History API的支持程度。</span></span></p></div></div></details><div id="https://www.notion.so/dc5b6279fd174bb4ac9f14d8522abdf0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其次是一些网页后来我们改成用变量表示了，因为要上传云上，所以导致有些path可能不对（少了/），我这次也全部改一下。比如在 Book.js 中，我就改成了：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">BOOK_SERVER_URL+`/books/${book_id}`</code></span><span class="SemanticString"> </span></span></p></div><div id="https://www.notion.so/fb593fae8ec749eba42a7930f4b39b17" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">然后是所有的弹窗式update无法返回原来页面的问题，这是因为我用了&lt;HashRouter&gt;之后出现的，解决方法：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">await navigate(-1);</code></span><span class="SemanticString"> ；也有一些本来的路径跳转需要改，如：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">navigate(&quot;/login&quot;)</code></span><span class="SemanticString"> </span></span></p></div><details id="https://www.notion.so/ca1e0cbf39c144b78f37b7e4745e9bc0" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">问chatgpt：window.location.href与useNavigate的区别？</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/eced1e2ebdc64b78a40d92cf2da22a17" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">&quot;window.location.href&quot;是JavaScript中的一个API，可以获取或设置当前页面的URL。当你使用&quot;window.location.href&quot;来实现编程式导航时，它会在浏览器中执行标准的页面刷新和导航，这意味着整个页面将重新加载，所有的JavaScript状态和数据都将丢失。</span></span></p></div><div id="https://www.notion.so/b51fef851e4847b985e4c34feb32efd8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">相比之下，&quot;useNavigate&quot;是React Router v6中提供的一个钩子函数，可以用于在React应用程序中进行编程式导航。当你使用&quot;useNavigate&quot;来实现编程式导航时，它会使用React Router的客户端路由机制，在不刷新整个页面的情况下导航到特定的路由，从而保留当前页面的JavaScript状态和数据。</span></span></p></div><div id="https://www.notion.so/349c89382216450e885b3808d8d09ab8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">综上所述，&quot;window.location.href&quot;和&quot;useNavigate&quot;都可以用于实现在React应用程序中进行编程式导航，但是它们之间的主要区别在于导航时是否执行标准的页面刷新和导航，以及是否保留当前页面的JavaScript状态和数据。</span></span></p></div></div></details><div id="https://www.notion.so/70b462c3bbfd4926942de612aa062c2d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最后把那个 LoginWithEmail.js 的垃圾功能删掉了。</span></span></p></div><div id="https://www.notion.so/d50410cecd8b4af5babe5218c2a34532" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">终于这个版本的代码在pip run build之后没有任何问题的上传到s3上，然后可以正确跳转页面了。关于如何上传React single-page到s3，请看</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.cloudthat.com/resources/blog/step-by-step-guide-to-deploy-reactjs-app-on-aws-s3/">这里</a></span><span class="SemanticString">（第一次没改policy导致403）。</span></span></p></div><div id="https://www.notion.so/1e056f3103724006b79e0f7bda119b40" class="Bookmark"><a href="https://github.com/Iris1e27/book-subscription-system/tree/746894bff841f774f752a87f52aa96bf0f458668"><h5 class="Bookmark__Title">GitHub - Iris1e27/book-subscription-system at 746894bff841f774f752a87f52aa96bf0f458668</h5><p class="Bookmark__Desc">A cloud full stack web app for course COMS E6156. Contribute to Iris1e27/book-subscription-system development by creating an account on GitHub.</p><p class="Bookmark__Link">https://github.com/Iris1e27/book-subscription-system/tree/746894bff841f774f752a87f52aa96bf0f458668</p></a></div><div id="https://www.notion.so/492495b9fcc6421cb3ad6858694a9983" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">2）</span></span></p></div></article>
    <aside class="Aside">
        <a href="#content-html"><div id="up">👆</div></a>
        <a href="#message-board"><div id="down">👇</div></a>
    </aside>
    <div id="message-board"></div>
    <script src="https://utteranc.es/client.js"
        repo="Iris1e27/Iris1e27.github.io"
        issue-term="pathname"
        label="✨"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
  <footer class="Footer">
  <div>&copy; Jingtian的博客 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>
