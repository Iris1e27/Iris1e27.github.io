<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<link rel="stylesheet" type="text/css" href="css/CustomSetting.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🛤️&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>

  <title>透视HTTP协议&nbsp;|&nbsp;Jingtian的博客</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="透视HTTP协议">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📺&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🛤️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐣&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="tags.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🔖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Tags</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="posts.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📁&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Posts</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="projects.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📁&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Projects</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="discussion.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🗣️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Discusion</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="links.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🔗&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Links</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="todo.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📌&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>To-Do</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📺&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">透视HTTP协议</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Tue, Feb 21, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/总结.html">总结</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--orange">
            <a href="tag/前端.html">前端</a>
          </span>
        
      </div>
    
  </header>
    <div id="content-html"></div>
  <article id="https://www.notion.so/cafe543c541a47729fc1b0eceefc4f83" class="PageRoot"><div id="https://www.notion.so/42960e6d23684a7789784d4a742c2501" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">来自cjr学姐的推荐：透视 HTTP 协议：</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://time.geekbang.org/column/intro/100029001">https://time.geekbang.org/column/intro/100029001</a></span></span></p></div><ul id="https://www.notion.so/9130c4cd2862478491ffb7b07a5473a0" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/92da497802f541e9ba56674d95aadc1e"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">破冰篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/16e9357e8d534704b9360bf23214d460"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP过去</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/de78da6688754368b744fa31e1240e9e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP是什么</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5f654059da2447d180daf90983baceb2"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP的各种概念：浏览器、服务器、CDN、爬虫、HTML、网络服务、WAF、TCP/IP、DNS、URI/URL、HTTPS、代理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c705107a963a43d089fd0c6956378b77"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">四层和七层：TCP、OSI</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6c85f731b16b41db9e67e1152ce23d79"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">域名与域名解析过程</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/73cc77cc0cec4910b39411c3bd3f2312"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">实验工具：Wireshark、Chrome、OpenResty、Telnet</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/eae8e51ee07a46928d1281bbd1eace28"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">基础篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/21819adc942949089018c44798f9d2aa"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">键入网址再按下回车，后面究竟发生了什么</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0fb854ce15f84ba096c86a4636318dd0"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP报文：起始行、头部字段、消息正文</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ba3d056f76284f4fa049cd3fea1366ba"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP请求方法：GET/HEAD/POST/PUT</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/162601c774144c44b6d73977ecccf342"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">URI/URL：scheme :// host:port path ?query</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d3ef0f54dbec47ef9fe3fb21d9c8c210"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP响应状态码</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/632e4304992240a68be4c7cc93036ce6"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP协议特点</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7765ab1595b6452ebf15b0e34647930e"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">进阶篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0403d23bca244c31ad2887917d2343fd"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP的实体数据</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b65d89f335ad49daacdd8262cb5e72ca"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP传输大文件的方法：数据压缩、分块传输、范围请求、多段数据</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/30084e6109eb4c59a7261c0bc5ebc91a"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b763d256406748e4be5fffd025898cba"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/534225758bc542f19bd3986c6f1f7af6"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9e8e19b7306d49658f4d2ad9fa07b255"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/32ca53661a7d4e4e9d8c00b3027122ce"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">安全篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/719ed1792b01499ab1a5e94741beb74d"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">飞翔篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/71e5a614b5854751898565d87c248d17"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">探索篇</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e7c2a93ae9c541f6856b27fe754e5ae6"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">其他</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7b2ea6db30be4d55a6c6ba06db0bf276"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">思维导图</span></span></div></a></li></ul><h2 id="https://www.notion.so/92da497802f541e9ba56674d95aadc1e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/92da497802f541e9ba56674d95aadc1e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">破冰篇</span></span></h2><h3 id="https://www.notion.so/16e9357e8d534704b9360bf23214d460" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/16e9357e8d534704b9360bf23214d460"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP过去</span></span></h3><div id="https://www.notion.so/12bab1cb5e4642f3a9edc1cf441c6e41" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP协议始于Tim Berners-Lee的一个论文，其中确定了URI统一资源标识符，HTML超文本标记语言，HTTP超文本传输协议。</span></span></p></div><div id="https://www.notion.so/5f776624f3444d229c8ec4dfd496e0d3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP/0.9是个简单的文本协议，只能获取文本资源；HTTP/1.0确立了大部分现在使用的技术，但它不是正是标准；HTTP/1.1是目前互联网上使用最广泛的协议，功能也非常完善；HTTP/2基于Google的SPDY协议，注重性能改善，但还未普及；HTTP/3基于Google的QUIC协议，是将来的发展方向。</span></span></p></div><h3 id="https://www.notion.so/de78da6688754368b744fa31e1240e9e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/de78da6688754368b744fa31e1240e9e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP是什么</span></span></h3><div id="https://www.notion.so/0a3f42f6b40749feaaf2cbb349b002e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">协议：确定了一种计算机之间的交流通信规范，以及各种控制和错误处理方式。</span></span></p></div><div id="https://www.notion.so/24c29da825a54af1914ff891b71052ed" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">传输协议：双向协议（请求方和响应方，允许中间有中转）。</span></span></p></div><div id="https://www.notion.so/c2f6c2550a6541e8814e703ca2f79144" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">超文本：HTML，文字，图片，视频，超链接等。</span></span></p></div><div id="https://www.notion.so/a00a618bcddc47c0a5763f6a25799474" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP非常灵活，可以包装各种网络应用，使之可以用HTTP访问，如：微信网页版，邮箱网页版。</span></span></p></div><h3 id="https://www.notion.so/5f654059da2447d180daf90983baceb2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/5f654059da2447d180daf90983baceb2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP的各种概念：浏览器、服务器、CDN、爬虫、HTML、网络服务、WAF、TCP/IP、DNS、URI/URL、HTTPS、代理</span></span></h3><div id="https://www.notion.so/22bc09a585da48b28bbfbf70a5486eab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">浏览器</strong></span><span class="SemanticString">：本质上是一个HTTP协议中的请求方。在HTTP协议中，浏览器的角色被称为User Agent用户代理，意思是作为访问者的”代理“来发起HTTP请求，所以我们也会称之为”客户端“。如：Chrome，FireFox，Safari，IE等。</span></span></p></div><div id="https://www.notion.so/99d379d3818f409283aca75657daa3fb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Web Server服务器</strong></span><span class="SemanticString">：HTTP协议中的响应方，包括硬件和软件。如：apache（老牌服务器，功能完善，学习门槛低），nginx（高性能，高稳定，易于扩展，适合高流量网站），IIS，Jetty/Tomcat（应用少）。</span></span></p></div><div id="https://www.notion.so/b3a727918757469189757c963b20e091" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">CDN</strong></span><span class="SemanticString">：浏览器和服务器中间的东西，叫内容分发网络，应用HTTP协议中的缓存和代理技术，代替源站响应客户端的请求。好处是浏览器的请求不用千里迢迢来到源站服务器，而是可以半路获取响应。作用是网络加速，负载均衡，安全防护，边缘计算，跨运营商网络。CDN无法缓存动态资源。</span></span></p></div><div id="https://www.notion.so/88cdd261281c4bd2a710f2a9b2e7eba6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">爬虫 crawler</strong></span><span class="SemanticString">：HTTP协议没规定用户代理必须是人，于是机器人即是爬虫。有爬虫和反爬虫，用robots.txt来约定什么可以爬什么不行。用到HTTP和HTML的技术。</span></span></p></div><div id="https://www.notion.so/fb9b351c34f640b880abbbc9cc627c24" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTML</strong></span><span class="SemanticString">：HTML4和HTML是两个主要的标准。</span></span></p></div><div id="https://www.notion.so/34a344547017450e9963b977e92a00a8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">WebService</strong></span><span class="SemanticString">：不是Web server，是由W3C定义的应用服务开发规范，使用client-server架构，通常使用WSDL定义服务接口，使用HTTP协议传输XML或者SOAP消息。它是一个基于web（HTTP）的服务架构技术。如：服务器端用Linux+Java，客户端用Windows+C#。即该技术的实现是web server。</span></span></p></div><div id="https://www.notion.so/c6314dc4c2d7432483d0ae5c90ac51de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">WAF</strong></span><span class="SemanticString">：网络应用防火墙，应用层面的防火墙，专门检测HTTP流量，防护Web应用的安全技术。通常位于Web服务器之前，阻止SQL注入，跨站脚本等。应用较多的开源项目是ModSecurity，可以集成到Apache和Nginx中。</span></span></p></div><div id="https://www.notion.so/621b4549f268414c864cc53e8ff4cccc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP/IP</strong></span><span class="SemanticString">：一系列的网络通信协议统称，最核心的是TCP（传输层，传输控制协议，提供可靠字节流通信，数据不丢失且完整）和IP（网际层，IP协议，解决寻址和路由问题，v4v6），还有UDP，ICMP，ARP等。HTTP全称：HTTP over TCP/IP。</span></span></p></div><div id="https://www.notion.so/116bc330ec3b42049d617a5ef7ce9a4a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DNS</strong></span><span class="SemanticString">：IP难记，所以引入域名系统DNS。域名domain name又称主机名host，最右边是顶级域名。域名解析就是将域名转换映射到它真正的IP。</span></span></p></div><div id="https://www.notion.so/043f40eedf7842d09c321560fcf04993" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI/URL</strong></span><span class="SemanticString">：identifier统一资源标识符，可以唯一标记网上资源，包括协议名，主机名和路径，如：http://nginx.org/en/download.html；locator统一资源定位符，即网址，是URI子集。</span></span></p></div><div id="https://www.notion.so/f61b33c2968c4c839b58fce78bfa74a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTPS</strong></span><span class="SemanticString">：全称HTTP over SSL/TLS，它是一个负责加密通信的协议，建立在TCP/IP之上，所以相当于HTTP+SSL/TLS+TCP/IP。SSL叫Secure Socket Layer（使用最新密码学成果），TLS叫Ttransport Layer Security。</span></span></p></div><div id="https://www.notion.so/4e6b0181bb9940af9bee9a17de7ef892" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代理 proxy</strong></span><span class="SemanticString">：HTTP协议中请求方和响应方中间的中转站。很多种类，如：</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">匿名代理</strong></span><span class="SemanticString">（完全隐匿的只能看到代理服务器），</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">透明代理</strong></span><span class="SemanticString">（外界知道代理也知道客户端），</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">正向代理</strong></span><span class="SemanticString">（靠近客户端，代表客户端向服务器发请求），</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">反向代理</strong></span><span class="SemanticString">（靠近服务器端，代表服务器响应客户端请求）。CDN是一种代理，扮演着透明代理和反向代理的角色。代理可以做：负载均衡（访问请求均匀分散到多台机子），内容缓存（暂存上下行数据减轻后端压力），安全防护（隐匿IP，使用WAF），数据处理（提供压缩加密）。</span></span></p></div><h3 id="https://www.notion.so/c705107a963a43d089fd0c6956378b77" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c705107a963a43d089fd0c6956378b77"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">四层和七层：TCP、OSI</span></span></h3><div id="https://www.notion.so/f4a0c01953524b6ea0a21bd1e2eec8fb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP/IP网络分层模型</strong></span><span class="SemanticString">：四层，链接层（以太网、WiFi这样的底层网络上发送原始数据包，使用MAC地址，帧frame）-&gt;网际层（用IP地址取代MAC地址，把局域网广域网再接成一个虚拟的巨大网络，包package）-&gt;传输层（TCP连续的字节流有顺序，UDP分散的小数据包顺序发乱序接，段segment）-&gt;应用层（Telnet、SSH、FTP、SMTP，消息或报文message）。</span></span></p></div><div id="https://www.notion.so/a5a7d527a4274906b36716719662fbb5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OSI网络分层模型</strong></span><span class="SemanticString">：open system interconnection reference model，七层，物理层-&gt;数据链路层-&gt;网络层-&gt;传输层-&gt;会话层-&gt;表示层-&gt;应用层。与TCP/IP有对应关系。</span></span></p></div><div id="https://www.notion.so/c4bdf67cc97f48cd85713306893a7caa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">辨别：凡是由操作系统负责处理的就是四层或四层以下；凡是需要由应用程序负责处理的就是七层。</span></span></p></div><div id="https://www.notion.so/1c6c512f26b84c30be920d4f6595cdbb" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1b0c7065-5004-49b4-882f-b6b96d1d1d8e%2FUntitled.png?width=576&amp;table=block&amp;id=1c6c512f-26b8-4c30-be92-0d4f6595cdbb"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1b0c7065-5004-49b4-882f-b6b96d1d1d8e%2FUntitled.png?width=576&amp;table=block&amp;id=1c6c512f-26b8-4c30-be92-0d4f6595cdbb" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ab7b7923b2164179b01819c983fb6953" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">四层负载均衡：工作在传输层上，基于TCP/IP协议的特性，例如IP地址，端口号等实现对后端服务器的负载均衡。</span></span></p></div><div id="https://www.notion.so/0bbe46501b7747f2a559c23ce571771b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">七层负载均衡：工作在应用层上，看到的是HTTP协议，解析HTTP报文里的URI、主机名、资源类型等数据，再用适当的策略转发给后端服务器。（区别是能否看到URI之类的）</span></span></p></div><h3 id="https://www.notion.so/6c85f731b16b41db9e67e1152ce23d79" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6c85f731b16b41db9e67e1152ce23d79"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">域名与域名解析过程</span></span></h3><div id="https://www.notion.so/d7307e56a79a4f1c891ed31e58a68ffd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">域名的形式：主机名.二级域名.顶级域名。</span></span></p></div><div id="https://www.notion.so/671daf232de64b3888ae79382cfd6739" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">域名解析：就像IP地址必须转换成MAC地址才能访问主机一样，域名也必须要转换成IP地址。如Nginx中，使用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">server_name time.geekbang.org</code></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/bc50b534393f40b29e3b01d965ce9500" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DNS的核心系统</strong></span><span class="SemanticString">：1）root根域名服务器：返回com net cn等顶级域名的IP地址（全球13组，无数镜像）；2）top-level顶级域名服务器：管理各自域名下权威域名服务器，比如com顶级域名服务器可以返回apple.com的IP地址；3）authoritative 权威域名服务器：管理自己域名下主机的IP地址，比如apple.com返回www.apple.com的IP地址。</span></span></p></div><div id="https://www.notion.so/40a577d7dd274637b00bc4abe9665b1a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">两种减轻域名解析压力的手段</strong></span><span class="SemanticString">：基本思路是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">缓存</strong></span><span class="SemanticString">。1）许多大公司、网络运营商都会建立自己的DNS服务器，叫做非权威域名服务器，作为用户DNS的代理，查询IP地址，如果有了记录则直接返回IP。如Google的8.8.8.8，MSFT的4.2.2.1。2）操作系统也会对DNS解析结果做缓存，如果在缓存找不到也会搜/etc/hosts主机映射文件。如Nginx中，使用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">resolver 8.8.8.8 valid=30s; #指定Google的DNS，缓存30秒</code></span><span class="SemanticString"> ，没有resolver则无法查询。</span></span></p></div><div id="https://www.notion.so/13e596a3ea1f471d94c358f8aa149484" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">域名其它功能：1）重定向。2）可以使用 bind9 等开源软件搭建一个在内部使用的 DNS，开发的各种内部服务就都用域名来标记。3）基于域名实现的负载均衡（见下）。4）域名屏蔽或域名劫持。</span></span></p></div><div id="https://www.notion.so/cb2552eb765a4e4f80f2b9b6ed45c89c" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb09bd917-ec01-41c8-8ede-92036a8722a2%2FUntitled.png?width=1385&amp;table=block&amp;id=cb2552eb-765a-4e4f-80f2-b9b6ed45c89c"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb09bd917-ec01-41c8-8ede-92036a8722a2%2FUntitled.png?width=1385&amp;table=block&amp;id=cb2552eb-765a-4e4f-80f2-b9b6ed45c89c" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3f91276778a34cca8d35fbe6ed66170e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">问：在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。</strong></span></span></p></div><div id="https://www.notion.so/2b30decc351d436f95e8dece8a2e1f1f" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa04000c6-1b02-4e6a-9f90-52cef77571a8%2FUntitled.png?width=1447&amp;table=block&amp;id=2b30decc-351d-436f-95e8-dece8a2e1f1f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa04000c6-1b02-4e6a-9f90-52cef77571a8%2FUntitled.png?width=1447&amp;table=block&amp;id=2b30decc-351d-436f-95e8-dece8a2e1f1f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/73cc77cc0cec4910b39411c3bd3f2312" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/73cc77cc0cec4910b39411c3bd3f2312"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">实验工具：Wireshark、Chrome、OpenResty、Telnet</span></span></h3><div id="https://www.notion.so/77031c70b9c44664822027f6132925f8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们选择 Wireshark 作为抓包工具，捕获在 TCP/IP 协议栈中传输的所有流量；</span></span></p></div><div id="https://www.notion.so/fe63bc7af2684ff9baa9f3bc9b458cde" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们选择 Chrome 或 Firefox 浏览器作为 HTTP 协议中的 user agent；</span></span></p></div><div id="https://www.notion.so/7b9b19b2997f435e9c2523e1aa34e14c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们选择 OpenResty 作为 Web 服务器，它是一个 Nginx 的“强化包”，功能非常丰富；</span></span></p></div><div id="https://www.notion.so/427d1a911d7a40dd82f95f7039440840" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Telnet 是一个命令行工具，可用来登录主机模拟浏览器操作；</span></span></p></div><div id="https://www.notion.so/b3c69e5b03444abcb4152cad05a7ac5d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在 GitHub 上可以下载到本专栏的专用项目源码，只要把 OpenResty 解压到里面即可完成实验环境的搭建。</span></span></p></div><h2 id="https://www.notion.so/eae8e51ee07a46928d1281bbd1eace28" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/eae8e51ee07a46928d1281bbd1eace28"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">基础篇</span></span></h2><h3 id="https://www.notion.so/21819adc942949089018c44798f9d2aa" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/21819adc942949089018c44798f9d2aa"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">键入网址再按下回车，后面究竟发生了什么</span></span></h3><div id="https://www.notion.so/b3808a5b47fa4168a99d48bf053834b5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">使用 IP 地址访问 Web 服务器：</strong></span></span></p></div><div id="https://www.notion.so/b224834ee73d4e95ba68db1ecffad87c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1）浏览器从地址栏的输入中获得服务器的 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">IP 地址和端口号</strong></span><span class="SemanticString">；2）浏览器用 TCP 的三次握手与服务器建立连接；3）浏览器向服务器发送拼好的报文；4）服务器收到报文后处理请求，同样拼好报文再发给浏览器；5）浏览器解析报文，渲染输出页面。</span></span></p></div><div id="https://www.notion.so/e157e5bd2dd54822a1094994ab974a7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">图里 TCP 关闭连接的“四次挥手”在抓包里没有出现，这是因为 HTTP/1.1 长连接特性，默认不会立即关闭连接。</span></span></p></div><div id="https://www.notion.so/96bfad202b554e438ec3458147d88ca7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">现代浏览器都会自动且秘密发送favicon.ico的请求。</span></span></p></div><div id="https://www.notion.so/da7af8aec9224f25b615b5ee87062422" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb219b8c2-3ffa-4150-97af-1432689b25f9%2FUntitled.png?width=432&amp;table=block&amp;id=da7af8ae-c922-4f25-b615-b5ee87062422"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb219b8c2-3ffa-4150-97af-1432689b25f9%2FUntitled.png?width=432&amp;table=block&amp;id=da7af8ae-c922-4f25-b615-b5ee87062422" style="width:432px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1dff39824ca240e7ac944dbd8c97ee0a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">使用域名访问 Web 服务器：</strong></span></span></p></div><div id="https://www.notion.so/1699f17709a649b49bf91f3fe4228241" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2bc6472f-ec25-4340-97ed-3c4f1b9473d6%2FUntitled.png?width=624&amp;table=block&amp;id=1699f177-09a6-49b4-9bf9-1f3fe4228241"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2bc6472f-ec25-4340-97ed-3c4f1b9473d6%2FUntitled.png?width=624&amp;table=block&amp;id=1699f177-09a6-49b4-9bf9-1f3fe4228241" style="width:624px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/258ee797025e4305a86d36e390cc48f2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首先</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">要拿到IP地址</strong></span><span class="SemanticString">，这就要用 DNS 协议开始从操作系统、本地 DNS、根 DNS、顶级 DNS、权威 DNS 的层层解析，当然这中间有缓存，可能不会费太多时间就能拿到结果。有时候会拿到CDN 服务器而不是目标网站的实际地址。</span></span></p></div><div id="https://www.notion.so/f51eefbca326412f989f1cae44ec0879" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">目标网站的服务器对外表现的是一个 IP 地址</strong></span><span class="SemanticString">，但为了能够扛住高并发，在内部也是一套复杂的架构。通常在</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">入口是负载均衡设备</strong></span><span class="SemanticString">，例如四层的 LVS 或者七层的 Nginx，在后面是许多的服务器，构成一个更强更稳定的集群。</span></span></p></div><div id="https://www.notion.so/54bd3c37948e4079b494381223678cc1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">负载均衡设备会先访问系统里的缓存服务器</strong></span><span class="SemanticString">，通常有 memory 级缓存 Redis 和 disk 级缓存 Varnish，它们的作用与 CDN 类似，不过是工作在内部网络里，把最频繁访问的数据缓存几秒钟或几分钟，减轻后端应用服务器的压力。</span></span></p></div><div id="https://www.notion.so/4387f6c8b9854fc68722f923105d9c6e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如果缓存服务器里也没有，那么负载均衡设备就要把请求转发给应用服务器了</strong></span><span class="SemanticString">。这里就是各种开发框架大显神通的地方了，例如 Java 的 Tomcat/Netty/Jetty，Python 的 Django，还有 PHP、Node.js、Golang 等等。它们又会再访问后面的 MySQL、PostgreSQL、MongoDB 等数据库服务，实现用户登录、商品查询、购物下单、扣款支付等业务操作，然后把执行的结果返回给负载均衡设备，同时也可能给缓存服务器里也放一份。</span></span></p></div><div id="https://www.notion.so/bd136ede7d4c448788db9e96da9d29cc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">应用服务器的输出到了负载均衡设备这里，请求的处理就算是完成了，就要按照原路再走回去</strong></span><span class="SemanticString">，还是要经过许多的路由器、网关、代理。如果这个资源允许缓存，那么</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">经过 CDN 的时候它也会做缓存</strong></span><span class="SemanticString">，这样下次同样的请求就不会到达源站了。</span></span></p></div><div id="https://www.notion.so/6e705323a3414f97a3a299b961872a1b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最后网站的响应数据回到了你的设备，它可能是 HTML、JSON、图片或者其他格式的数据，需要由浏览器解析处理才能显示出来，如果数据里面还有超链接，指向别的资源，那么就又要重走一遍整个流程，直到所有的资源都下载完。</span></span></p></div><h3 id="https://www.notion.so/0fb854ce15f84ba096c86a4636318dd0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/0fb854ce15f84ba096c86a4636318dd0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP报文：起始行、头部字段、消息正文</span></span></h3><div id="https://www.notion.so/7e3b852a7ad64a0a967db8f38ceee17f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP 协议与 TCP/UDP 类似，但不同在：它是一个“纯文本”的协议，所以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">头数据都是 ASCII 码的文本</strong></span><span class="SemanticString">，可以很容易地用肉眼阅读，不用借助程序解析也能够看懂。TCP报文格式如下：</span></span></p></div><div id="https://www.notion.so/c9c0c336d71547ee9a99f6583165655f" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4220e47b-d058-4118-af34-1fcdacfe3259%2FUntitled.png?width=624&amp;table=block&amp;id=c9c0c336-d715-47ee-9a99-f6583165655f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4220e47b-d058-4118-af34-1fcdacfe3259%2FUntitled.png?width=624&amp;table=block&amp;id=c9c0c336-d715-47ee-9a99-f6583165655f" style="width:624px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/85599466ea7947559527bb37e64b258c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP 协议的请求报文和响应报文的结构</strong></span><span class="SemanticString">基本相同，由三大部分组成：1）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">起始行</strong></span><span class="SemanticString">（start line）：描述请求或响应的基本信息；2）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">头部字段集合</strong></span><span class="SemanticString">（header）：使用 key-value 形式更详细地说明报文；3）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">消息正文</strong></span><span class="SemanticString">（entity）：实际传输的数据，它不一定是纯文本，可以是图片、视频等二进制数据。前两部分起始行和头部字段经常又合称为“请求头”或“响应头”。</span></span></p></div><div id="https://www.notion.so/d358f5392ea844b89ccbc6cc7855009a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP 协议规定报文</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">必须有 header，但可以没有 body，而且在 header 之后必须要有一个“空行”</strong></span><span class="SemanticString">，也就是“CRLF”，十六进制的“0D0A”。虽然 HTTP 协议对 header 的大小没有做限制，但各个 Web 服务器都不允许过大的请求头，因为头部太大可能会占用大量的服务器资源，影响运行效率。</span></span></p></div><div id="https://www.notion.so/804601c984934be0ac6168c0fc912cde" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5887c8b2-4fc3-4382-9c7e-f44699004759%2FUntitled.png?width=624&amp;table=block&amp;id=804601c9-8493-4be0-ac61-68c0fc912cde"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5887c8b2-4fc3-4382-9c7e-f44699004759%2FUntitled.png?width=624&amp;table=block&amp;id=804601c9-8493-4be0-ac61-68c0fc912cde" style="width:624px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/617d94554ba44a78922a6458db400b3d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">起始行</strong></span></span></p></div><div id="https://www.notion.so/6f958efc0a8647c2b1ce42cf746a3a66" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求行</strong></span><span class="SemanticString">：请求报文里的起始行也就是请求行（request line），它简要地描述了</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端想要如何操作服务器端的资源</strong></span><span class="SemanticString">。如：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">GET / HTTP/1.1</code></span></span></p></div><div id="https://www.notion.so/5e4e58c1370f4763a68a69eb192d357f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求行的三部分组成</strong></span><span class="SemanticString">：1）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求方法</strong></span><span class="SemanticString">：是一个动词，如 GET/POST，表示对资源的操作；2）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求目标</strong></span><span class="SemanticString">：通常是一个 URI，标记了请求方法要操作的资源；3）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">版本号</strong></span><span class="SemanticString">：表示报文使用的 HTTP 协议版本。这三个部分通常使用空格（space）来分隔，最后要用 CRLF 换行表示结束。</span></span></p></div><div id="https://www.notion.so/6314b91167794751a260ca2beae3a2a8" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F833ddc58-4812-46f2-892c-f393b7de3940%2FUntitled.png?width=3000&amp;table=block&amp;id=6314b911-6779-4751-a260-ca2beae3a2a8"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F833ddc58-4812-46f2-892c-f393b7de3940%2FUntitled.png?width=3000&amp;table=block&amp;id=6314b911-6779-4751-a260-ca2beae3a2a8" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/894a341289b943cabc721ca76ceeeb3b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态行</strong></span><span class="SemanticString">：响应报文里的起始行，在这里它不叫“响应行”，而是叫“状态行”（status line），意思是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器响应的状态</strong></span><span class="SemanticString">。如：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">HTTP/1.1 200 OK</code></span></span></p></div><div id="https://www.notion.so/f40caf9c7b64497ca0185d5ec5aad303" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态行的三部分组成</strong></span><span class="SemanticString">：1）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">版本号</strong></span><span class="SemanticString">：表示报文使用的 HTTP 协议版本；2）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态码</strong></span><span class="SemanticString">：一个三位数，用代码的形式表示处理的结果，比如 200 是成功，500 是服务器错误；3）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">原因</strong></span><span class="SemanticString">：作为数字状态码补充，是更详细的解释文字，帮助人理解原因。</span></span></p></div><div id="https://www.notion.so/085ffcac413042e086cd3ce5475f2c30" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fca554ac3-8a90-443c-905c-7e0e6b4c7797%2FUntitled.png?width=3000&amp;table=block&amp;id=085ffcac-4130-42e0-86cd-3ce5475f2c30"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fca554ac3-8a90-443c-905c-7e0e6b4c7797%2FUntitled.png?width=3000&amp;table=block&amp;id=085ffcac-4130-42e0-86cd-3ce5475f2c30" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/21e9dcd53e714808bdae7ae1dbf20722" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">头部字段</strong></span></span></p></div><div id="https://www.notion.so/1893905027de40899bae9da81ff3e9e5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">头部字段</strong></span><span class="SemanticString">是 key-value 的形式，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">key 和 value 之间用“:”分隔</strong></span><span class="SemanticString">，最后用 CRLF 换行表示字段结束。比如在“Host: 127.0.0.1”这一行里 key 就是“Host”，value 就是“127.0.0.1”。HTTP 头字段非常灵活，不仅可以使用标准里的 Host、Connection 等已有头，也可以任意添加自定义头，这就给 HTTP 协议带来了无限的扩展可能。以下为请求报文和响应报文：</span></span></p></div><div id="https://www.notion.so/8ebb0ad15e5f40d7b6ac689700d8bfdd" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F71733899-4a61-4952-943c-f6d40297a07d%2FUntitled.png?width=528&amp;table=block&amp;id=8ebb0ad1-5e5f-40d7-b6ac-689700d8bfdd"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F71733899-4a61-4952-943c-f6d40297a07d%2FUntitled.png?width=528&amp;table=block&amp;id=8ebb0ad1-5e5f-40d7-b6ac-689700d8bfdd" style="width:528px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/a2b8b9dcede84f8da4e4ad0088242c3e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">不过使用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">头字段需要注意下面几点</strong></span><span class="SemanticString">：</span></span></p></div><div id="https://www.notion.so/fcc6169740eb4721b0cf7c1a6a98682a" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F68c7263e-1e99-4745-a06c-78b107a3445c%2FUntitled.png?width=672&amp;table=block&amp;id=fcc61697-40eb-4721-b0cf-7c1a6a98682a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F68c7263e-1e99-4745-a06c-78b107a3445c%2FUntitled.png?width=672&amp;table=block&amp;id=fcc61697-40eb-4721-b0cf-7c1a6a98682a" style="width:672px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/a3c2e4896b61466a83338a7d7b017065" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">常用的头字段</strong></span><span class="SemanticString">：1）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通用字段</strong></span><span class="SemanticString">：在请求头和响应头里都可以出现；2）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求字段</strong></span><span class="SemanticString">：仅能出现在请求头里，进一步说明请求信息或者额外的附加条件；3）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">响应字段</strong></span><span class="SemanticString">：仅能出现在响应头里，补充说明响应报文的信息；4）</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实体字段</strong></span><span class="SemanticString">：它实际上属于通用字段，但专门描述 body 的额外信息。</span></span></p></div><div id="https://www.notion.so/ab0e65ea06164fe5a0a1403103ff4b0d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Host </strong></span><span class="SemanticString">字段：它属于请求字段，只能出现在请求头里，它同时也是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">唯一一个 HTTP/1.1 规范里要求必须出现的字段</strong></span><span class="SemanticString">，也就是说，如果请求头里没有 Host，那这就是一个错误的报文。</span></span></p></div><div id="https://www.notion.so/16c7f93b35d5468d829dedf46ed7cd9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">User-Agent </strong></span><span class="SemanticString">字段：请求字段，只出现在请求头里。它使用一个字符串来描述发起 HTTP 请求的客户端，服务器可以依据它来返回最合适此浏览器显示的页面。但由于历史的原因，User-Agent 非常混乱，每个浏览器都自称是“Mozilla”“Chrome”“Safari”，企图使用这个字段来互相“伪装”，导致 User-Agent 变得越来越长，最终变得毫无意义。</span></span></p></div><div id="https://www.notion.so/1d23dfb546ec4fa38712651901892d72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Date </strong></span><span class="SemanticString">字段：是一个通用字段，但通常出现在响应头里，表示 HTTP 报文创建的时间，客户端可以使用这个时间再搭配其他字段决定缓存策略。</span></span></p></div><div id="https://www.notion.so/22dcefab567a40218018f6323033d474" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Server</strong></span><span class="SemanticString"> 字段：是响应字段，只能出现在响应头里。它告诉客户端当前正在提供 Web 服务的软件名称和版本号，例如在我们的实验环境里它就是“Server: openresty/1.15.8.1”，即使用的是 OpenResty 1.15.8.1。但由于安全问题，有的网站响应头里要么没有这个字段，要么就给出一个完全无关的描述信息。比如 GitHub，它的 Server 字段里就看不出是使用了 Apache 还是 Nginx，只是显示为“GitHub.com”。</span></span></p></div><div id="https://www.notion.so/7c449ea8e0de42879bb3c7ee932b7f0c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Content-Length</strong></span><span class="SemanticString"> 字段：实体字段，它表示报文里 body 的长度，也就是请求头或响应头空行后面数据的长度。服务器看到这个字段，就知道了后续有多少数据，可以直接接收。如果没有这个字段，那么 body 就是不定长的，需要使用 chunked 方式分段传输。</span></span></p></div><h3 id="https://www.notion.so/ba3d056f76284f4fa049cd3fea1366ba" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ba3d056f76284f4fa049cd3fea1366ba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP请求方法：GET/HEAD/POST/PUT</span></span></h3><div id="https://www.notion.so/339a1f2d6a5f41518447f53dfde64386" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">标准请求方法：要求服务器端对 URI 定位的资源执行这个动作。目前 HTTP/1.1 规定了</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">八种方法</strong></span><span class="SemanticString">，单词都必须是大写的形式。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">GET</strong></span><span class="SemanticString">：获取资源，可以理解为读取或者下载数据；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HEAD</strong></span><span class="SemanticString">：获取资源的元信息；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">POST</strong></span><span class="SemanticString">：向资源提交数据，相当于写入或上传数据；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">PUT</strong></span><span class="SemanticString">：类似 POST；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">DELETE</strong></span><span class="SemanticString">：删除资源；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">CONNECT</strong></span><span class="SemanticString">：建立特殊的连接隧道；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OPTIONS</strong></span><span class="SemanticString">：列出可对资源实行的方法；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TRACE</strong></span><span class="SemanticString">：追踪请求 - 响应的传输路径。前四个常用。</span></span></p></div><div id="https://www.notion.so/dce0c60f8f4446f0af1f00bc76f7436e" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa8d0cc10-ecc7-442e-a2bc-511c957e47f1%2FUntitled.png?width=576&amp;table=block&amp;id=dce0c60f-8f44-46f0-af1f-00bc76f7436e"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa8d0cc10-ecc7-442e-a2bc-511c957e47f1%2FUntitled.png?width=576&amp;table=block&amp;id=dce0c60f-8f44-46f0-af1f-00bc76f7436e" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ae0a24c2b2d343cca2d34b4c11d22d9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">比如，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">你发起了一个 GET 请求，想获取“/orders”这个文件，但这个文件保密级别比较高，不是谁都能看的，服务器就可以有如下的几种响应方式</strong></span><span class="SemanticString">：1）假装这个文件不存在，直接返回一个 404 Not found 报文；2）稍微友好一点，明确告诉你有这个文件，但不允许访问，返回一个 403 Forbidden；3）再宽松一些，返回 405 Method Not Allowed，然后用 Allow 头告诉你可以用 HEAD 方法获取文件的元信息。</span></span></p></div><div id="https://www.notion.so/1425f1714c264107866efbc79be797ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">常用的四种方法</strong></span></span></p></div><div id="https://www.notion.so/113785e573bc4a49a705714a80273ee7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">GET</strong></span><span class="SemanticString">：请求</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">从服务器获取资源</strong></span><span class="SemanticString">。GET 方法虽然基本动作比较简单，但</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">搭配 URI 和其他头字段就能实现对资源更精细的操作</strong></span><span class="SemanticString">。例如，在 URI 后使用“#”，就可以在获取页面后直接定位到某个标签所在的位置；使用 If-Modified-Since 字段就变成了“有条件的请求”，仅当资源被修改时才会执行获取动作；使用 Range 字段就是“范围请求”，只获取资源的一部分数据。</span></span></p></div><div id="https://www.notion.so/3be48fc35d884b29ae7bed9f4a185df5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HEAD</strong></span><span class="SemanticString">：与 GET 方法类似，也是请求从服务器获取资源，服务器的处理机制也是一样的，但服务器不会返回请求的实体数据，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">只会传回响应头，也就是资源的“元信息”</strong></span><span class="SemanticString">。它</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用在不真正需要资源的场合</strong></span><span class="SemanticString">，避免传输 body 数据的浪费。比如，想要检查一个文件是否存在，只要发个 HEAD 请求就可以了，没有必要用 GET 把整个文件都取下来。再比如，要检查文件是否有最新版本，同样也应该用 HEAD，服务器会在响应头里把文件的修改时间传回来。</span></span></p></div><div id="https://www.notion.so/fe03be23581d4b258e0bd054c5def203" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">POST</strong></span><span class="SemanticString">：</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">向 URI 指定的资源提交数据</strong></span><span class="SemanticString">，数据就放在报文的 body 里。POST 也是一个经常用到的请求方法，使用频率应该是仅次于 GET，应用的场景也非常多，只要向服务器发送数据，用的大多数都是 POST。通常 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">POST 表示的是“新建”“create”</strong></span><span class="SemanticString">的含义。</span></span></p></div><div id="https://www.notion.so/0617cbf7b0af4eedb2128e5da9d287f6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">PUT</strong></span><span class="SemanticString">：与 POST 类似，也可以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">向服务器提交数据</strong></span><span class="SemanticString">，但与 POST 存在微妙的不同，通常 POST 表示的是“新建”“create”的含义，而</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> PUT 则是“修改”“update”</strong></span><span class="SemanticString">的含义。在实际应用中，PUT 用到的比较少。而且，因为它与 POST 的语义、功能太过近似，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">有的服务器甚至就直接禁止使用 PUT 方法</strong></span><span class="SemanticString">，只用 POST 方法上传数据。</span></span></p></div><div id="https://www.notion.so/8f79bfc26abf46e98e879adb9b667211" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">其他方法</strong></span></span></p></div><div id="https://www.notion.so/61bc0eb301c74be68454bbc2cc036aac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">DELETE：指示服务器删除资源，因为这个动作危险性太大，所以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通常服务器不会执行真正的删除操作，而是对资源做一个删除标记</strong></span><span class="SemanticString">。当然，更多的时候服务器就直接不处理 DELETE 请求。</span></span></p></div><div id="https://www.notion.so/fe5cedba84ee4a4fa866f37f8d7df04d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">CONNECT：是一个比较特殊的方法，要求服务器为客户端和另一台远程服务器建立一条特殊的连接隧道，这时 Web 服务器在中间充当了代理的角色。</span></span></p></div><div id="https://www.notion.so/d1e56d0b58ae40e1b209d31afdb633ef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">OPTIONS：要求服务器列出可对资源实行的操作方法，在响应头的 Allow 字段里返回。它的功能很有限，用处也不大，有的服务器（例如 Nginx）干脆就没有实现对它的支持。</span></span></p></div><div id="https://www.notion.so/0f6062932f3d4e468e35d8e6a1102701" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TRACE：多用于对 HTTP 链路的测试或诊断，可以显示出请求 - 响应的传输路径。它的本意是好的，但存在漏洞，会泄漏网站的信息，所以 Web 服务器通常也是禁止使用。</span></span></p></div><div id="https://www.notion.so/d13c2bc795b2449299e48dc474509c21" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">扩展方法</strong></span></span></p></div><div id="https://www.notion.so/73fa68802c4a4243a819f239f7a56c41" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">有一些得到了实际应用的请求方法（WebDAV），例如 MKCOL、COPY、MOVE、LOCK、UNLOCK、PATCH 等。如果有合适的场景，你也可以把它们应用到自己的系统里，比如用 LOCK 方法锁定资源暂时不允许修改，或者使用 PATCH 方法给资源打个小补丁，部分更新数据。但因为这些方法是非标准的，所以需要为客户端和服务器编写额外的代码才能添加支持。也可以根据需求创建方法。</span></span></p></div><div id="https://www.notion.so/a9b87af9c94644f093a0bd0acb42fdaf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">安全与幂等</strong></span></span></p></div><div id="https://www.notion.so/d27b7fd45c524eb7b84d74dd7ed5027c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">安全：指请求方法不会“破坏”服务器上的资源，即</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">不会对服务器上的资源造成实质的修改</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/dce9635f9cca4271852d98ee0a0e04a3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">幂等：意思是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">多次执行相同的操作，结果也都是相同的</strong></span><span class="SemanticString">，即多次“幂”后结果“相等”。</span></span></p></div><h3 id="https://www.notion.so/162601c774144c44b6d73977ecccf342" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/162601c774144c44b6d73977ecccf342"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">URI/URL：scheme :// host:port path ?query</span></span></h3><div id="https://www.notion.so/2a41075370d94c998b3ec0255b9471c2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI=URL</strong></span><span class="SemanticString">：严格地说，URI 不完全等同于网址，它包含有 URL 和 URN 两个部分，在 HTTP 世界里用的网址实际上是 URL——统一资源定位符（Uniform Resource Locator）。但因为 URL 实在是太普及了，所以常常把这两者简单地视为相等。URI的作用是唯一地标记资源的位置或者名字，“资源”既可以是存在磁盘上的静态文本、页面数据，也可以是由 Java、PHP 提供的动态服务。</span></span></p></div><div id="https://www.notion.so/45b1bb6093274f1480ebf948af8caf63" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 一般形式</strong></span></span></p></div><div id="https://www.notion.so/77fb572696a840a58b8a661151be8b6e" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F7f029118-8040-41b8-9dac-404747455612%2FUntitled.png?width=1548&amp;table=block&amp;id=77fb5726-96a8-40a5-8b8a-661151be8b6e"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F7f029118-8040-41b8-9dac-404747455612%2FUntitled.png?width=1548&amp;table=block&amp;id=77fb5726-96a8-40a5-8b8a-661151be8b6e" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/32eea8b4f0f34bb9a4fb2683f05002d7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">scheme</strong></span><span class="SemanticString">：翻译成中文叫“方案名”或者“协议名”，表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">资源应该使用哪种协议来访问</strong></span><span class="SemanticString">。最常见的当然就是“http”了，表示使用 HTTP 协议。另外还有“https”，表示使用经过加密、安全的 HTTPS 协议。此外还有其他不是很常见的 scheme，例如 ftp、ldap、file、news 等。</span></span></p></div><div id="https://www.notion.so/5ae42508e60a45569f7b91d6c6fdf214" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">host:port</strong></span><span class="SemanticString">：在“://”之后，是被称为“authority”的部分，表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">资源所在的主机名</strong></span><span class="SemanticString">，通常的形式是“host:port”，即主机名加端口号。主机名必须有，但端口号有时可以省略，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">浏览器等客户端会依据 scheme 使用默认的端口号</strong></span><span class="SemanticString">，例如 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP 的默认端口号是 80</strong></span><span class="SemanticString">，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTPS 的默认端口号是 443</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/be3644ee905049099cc0dce8c60dcd0e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">path</strong></span><span class="SemanticString">：标记资源所在位置的 path，浏览器就可以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">连接服务器访问资源了</strong></span><span class="SemanticString">。URI 里 path 采用了类似文件系统“目录”“路径”的表示方式，因为早期互联网上的计算机多是 UNIX 系统，所以采用了 UNIX 的“/”风格。请注意：</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 的 path 部分必须以“/”开始，“/”不属于 host:port 内容</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/970c4634d97d40fea83af4f2ca50e579" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">特殊例子：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">file:///D:/http_study/www/</code></span><span class="SemanticString"> 中，“///”是因为”/”是主机名，file 类型 URI 的“特例”，它允许省略主机名，默认是本机 localhost。但对于 HTTP 或 HTTPS 这样的网络通信协议，主机名是绝对不能省略的。</span></span></p></div><div id="https://www.notion.so/1b7aaf46bab4434094d34298aa25fd1b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注意：客户端和服务器看到的 URI 是不一样的。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端看到的必须是完整的 URI</strong></span><span class="SemanticString">，使用特定的协议去连接特定的主机，而服务器看到的只是报文请求行里被删除了协议名和主机名的 URI，指的是真正 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 里的 path 和后续的部分</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/7b0e95e662494dc9b28886fd62dca8f1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 的查询参数</strong></span></span></p></div><div id="https://www.notion.so/d245a06117b444608b816313a2b123a9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">引入原因：使用“协议名 + 主机名 + 路径”的方式，已经可以精确定位网络上的任何资源了。但这还不够，很多时候我们还想</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">在操作资源的时候附加一些额外的修饰参数</strong></span><span class="SemanticString">。举几个例子：获取商品图片，但想要一个 32×32 的缩略图版本；获取商品列表，但要按某种规则做分页和排序；跳转页面，但想要标记跳转前的原始页面。</span></span></p></div><div id="https://www.notion.so/2ea978b696d547158bb6353adb73eb04" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">query</strong></span><span class="SemanticString">：URI 后面还有一个“query”部分，它</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">在 path 之后，用一个“?”开始，但不包含“?”，表示对资源附加的额外要求</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/ce43360d8e624502b810ed520c73077a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">查询参数 query 的格式</strong></span><span class="SemanticString">：是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">多个“key=value”的字符串，这些 KV 值用字符“&amp;”连接</strong></span><span class="SemanticString">，浏览器和服务器都可以按照这个格式把长串的查询参数解析成可理解的字典或关联数组形式。</span></span></p></div><div id="https://www.notion.so/c7c57f34793142b58d47b77df1f38a48" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注意：如果</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">查询参数过长，可以使用GET方法放在body里面请求服务器</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/cfcc883e1a3444589697f24fc840b5ac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 的完整格式</strong></span></span></p></div><div id="https://www.notion.so/1c4b699858fe4a26b53db4d7962d12e0" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9e4e481f-4eba-4aa7-a1dd-ee0e6704fa1f%2FUntitled.png?width=2023&amp;table=block&amp;id=1c4b6998-58fe-4a26-b53d-b4d7962d12e0"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9e4e481f-4eba-4aa7-a1dd-ee0e6704fa1f%2FUntitled.png?width=2023&amp;table=block&amp;id=1c4b6998-58fe-4a26-b53d-b4d7962d12e0" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/1ba21214249847e8be4d77deca97f7d5" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd26efa09-0c74-427a-ba95-1e52c861216f%2FUntitled.png?width=624&amp;table=block&amp;id=1ba21214-2498-47e8-be4d-77deca97f7d5"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd26efa09-0c74-427a-ba95-1e52c861216f%2FUntitled.png?width=624&amp;table=block&amp;id=1ba21214-2498-47e8-be4d-77deca97f7d5" style="width:624px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3735334e5c8243d6b1c5d9170eeb9d43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 的编码</strong></span></span></p></div><div id="https://www.notion.so/78c18a72839f46ba82fbcc311d429d9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">引入原因：在 URI 里只能使用 ASCII 码，但如果要在 URI 里使用英语以外的汉语、日语等其他语言该怎么办呢？还有，某些特殊的 URI，会在 path、query 里出现“@&amp;?&quot;等起界定符作用的字符，会导致 URI 解析错误，这时又该怎么办呢？</span></span></p></div><div id="https://www.notion.so/a49042b481594240818b36c1e0e78b5c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">URI 的编码机制</strong></span><span class="SemanticString">：把字符（unicode）编码成utf-8，utf-8是用1-4个字节表示的，所以每个字节转换成16进制并在前面用百分号（%）连接，最后并把每个字节转换的结果连接起来。</span></span></p></div><div id="https://www.notion.so/418a7aff32f94eb0be0bfbce79fb981d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注意：HTML转义用的“&amp;#”，URI转义用的“%”。</span></span></p></div><h3 id="https://www.notion.so/d3ef0f54dbec47ef9fe3fb21d9c8c210" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d3ef0f54dbec47ef9fe3fb21d9c8c210"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP响应状态码</span></span></h3><div id="https://www.notion.so/40fc6fd0ff664b1ca58b2d25b0796d87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">响应状态码位于响应报文。开头的 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Version</strong></span><span class="SemanticString"> 部分是 HTTP 协议的版本号，通常是 HTTP/1.1；后面的 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Reason </strong></span><span class="SemanticString">部分是原因短语，是状态码的简短文字描述，例如“OK”“Not Found”等等，也可以自定义。</span></span></p></div><div id="https://www.notion.so/834c824d4ae74e9f98e8cd86b9d1e656" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fecc65703-4458-4631-9f4b-566f068fa9c4%2FUntitled.png?width=672&amp;table=block&amp;id=834c824d-4ae7-4e9f-98e8-cd86b9d1e656"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fecc65703-4458-4631-9f4b-566f068fa9c4%2FUntitled.png?width=672&amp;table=block&amp;id=834c824d-4ae7-4e9f-98e8-cd86b9d1e656" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ebab2604f6ee47c49f812540219765c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态码</strong></span><span class="SemanticString">：状态行里有用的就只剩下中间的状态码（Status Code）了。它是一个十进制数字，以代码的形式表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器对请求的处理结果</strong></span><span class="SemanticString">。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">表达 HTTP 数据处理的“状态”</strong></span><span class="SemanticString">，客户端可以依据代码适时转换处理状态，例如继续发送请求、切换协议，重定向跳转等，有那么点 TCP 状态转换的意思。</span></span></p></div><div id="https://www.notion.so/58697c397efc459fb842b01300fa01dc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态码分类</strong></span><span class="SemanticString">：目前 RFC 标准里规定的状态码是三位数，所以取值范围就是从 000 到 999。RFC 标准把状态码分成了五类，用数字的第一位表示分类。</span></span></p></div><div id="https://www.notion.so/13c191e2ffa54e5dab153fde4bc057de" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3b90417b-d081-4642-bda1-27e4d55d0e14%2FUntitled.png?width=576&amp;table=block&amp;id=13c191e2-ffa5-4e5d-ab15-3fde4bc057de"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3b90417b-d081-4642-bda1-27e4d55d0e14%2FUntitled.png?width=576&amp;table=block&amp;id=13c191e2-ffa5-4e5d-ab15-3fde4bc057de" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f799a53885e9429b94652500d5c325db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">目前 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">RFC 标准里总共有 41 个状态码</strong></span><span class="SemanticString">，但</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">状态码的定义是开放的，允许自行扩展</strong></span><span class="SemanticString">。所以 Apache、Nginx 等 Web 服务器都定义了一些专有的状态码。如果你自己开发 Web 应用，也完全可以在不冲突的前提下定义新的代码。</span></span></p></div><div id="https://www.notion.so/5e1095830440414d906f182c85f9f353" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1 x x</strong></span><span class="SemanticString">：1××类状态码属于提示信息，是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">协议处理的中间状态</strong></span><span class="SemanticString">，实际能够用到的时候很少。</span></span></p></div><details id="https://www.notion.so/d2582e2b9ba14ef582d37ea08e00225a" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“101 Switching Protocols”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/add36744a825485ca298a40661d05728" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">它的意思是客户端使用 Upgrade 头字段，要求在 HTTP 协议的基础上改成其他的协议继续通信，比如 WebSocket。而如果服务器也同意变更协议，就会发送状态码 101，但这之后的数据传输就不会再使用 HTTP 了。</span></span></p></div></div></details><div id="https://www.notion.so/ce6ffd86e21746089345ab763f1e2037" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2 x x</strong></span><span class="SemanticString">：2××类状态码表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器收到并成功处理了客户端的请求</strong></span><span class="SemanticString">，这也是客户端最愿意看到的状态码。</span></span></p></div><details id="https://www.notion.so/36559f635f6f4753a10466798d3ba32a" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“200 OK”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/1939e14e29be42f3847815b70ed50f8f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">是最常见的成功状态码，表示一切正常，服务器如客户端所期望的那样返回了处理结果，如果是非 HEAD 请求，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通常在响应头后都会有 body 数据</strong></span><span class="SemanticString">。</span></span></p></div></div></details><details id="https://www.notion.so/ba2e09aaf9574382850464e74656dbc9" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“204 No Content”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/81c834eec1e7485dae74336a1cbb1831" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">是另一个很常见的成功状态码，它的含义与“200 OK”基本相同，但</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">响应头后没有 body 数据</strong></span><span class="SemanticString">。所以对于 Web 服务器来说，正确地区分 200 和 204 是很必要的。</span></span></p></div></div></details><details id="https://www.notion.so/6ec515e68bd446a0a85ce83284516322" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“206 Partial Content”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/00f36e2b409a4928bddc6ee91b557e35" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">是 HTTP 分块下载或断点续传的基础，在客户端发送“范围请求”、要求获取资源的部分数据时出现，它与 200 一样，也是服务器成功处理了请求，但 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">body 里的数据不是资源的全部，而是其中的一部分</strong></span><span class="SemanticString">。状态码 206 通常还会伴随着头字段</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“Content-Range”</strong></span><span class="SemanticString">，表示响应报文里 body 数据的具体范围，供客户端确认，例如“Content-Range: bytes 0-99/2000”，意思是此次获取的是总计 2000 个字节的前 100 个字节。</span></span></p></div></div></details><div id="https://www.notion.so/e07b22d20dd3465bbd07e80b0038dbcc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">3 x x</strong></span><span class="SemanticString">：3××类状态码表示客户端请求的资源发生了变动，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端必须用新的 URI 重新发送请求获取资源，也就是通常所说的“重定向”</strong></span><span class="SemanticString">，包括著名的 301、302 跳转。</span></span></p></div><details id="https://www.notion.so/d7b03a05425e4e78bd6f565ed88d642c" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“301 Moved Permanently”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/9ec8edafa45045ea964687c80c22f669" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">俗称“</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">永久重定向</strong></span><span class="SemanticString">”，含义是此次请求的资源已经不存在了，需要改用新的 URI 再次访问。在响应头里使用字段 Location 指明后续要跳转的 URI。比如，你的网站升级到了 HTTPS，原来的 HTTP 不打算用了，这就是“永久”的，所以要配置 301 跳转，把所有的 HTTP 流量都切换到 HTTPS。</span></span></p></div></div></details><details id="https://www.notion.so/908c9e92494e40cd809fcb224bf62cd8" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“302 Found”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/0c5f5aaf5cc946f4a26df4d73c7b6c43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">曾经的描述短语是“Moved Temporarily”，俗称“</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">临时重定向</strong></span><span class="SemanticString">”，意思是请求的资源还在，但需要暂时用另一个 URI 来访问。在响应头里使用字段 Location 指明后续要跳转的 URI。再比如，今天夜里网站后台要系统维护，服务暂时不可用，这就属于“临时”的，可以配置成 302 跳转，把流量临时切换到一个静态通知页面，浏览器看到这个 302 就知道这只是暂时的情况，不会做缓存优化，第二天还会访问原来的地址。</span></span></p></div></div></details><details id="https://www.notion.so/ea904e34936140a68962cb08b54f1e69" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“304 Not Modified”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/9a6fd0c325044ac996aada68105fe9f5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">是一个比较有意思的状态码，它用于 If-Modified-Since 等条件请求，表示资源未修改，用于缓存控制。它不具有通常的跳转含义，但可以理解成“重定向已到缓存的文件”（即“</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">缓存重定向</strong></span><span class="SemanticString">”）。您请求的网页自上次访问以来没有更改。之后，您的浏览器将检索</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">本地存储中的网页缓存版本</strong></span><span class="SemanticString">。</span></span></p></div></div></details><div id="https://www.notion.so/80df5cda1e774acdb674a1556dc5d36a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">4 x x</strong></span><span class="SemanticString">：4××类状态码表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端发送的请求报文有误，服务器无法处理</strong></span><span class="SemanticString">，它就是真正的“错误码”含义了。</span></span></p></div><details id="https://www.notion.so/b99780703edd4d0886f471c0048e4ede" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“400 Bad Request”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/13a5602397454692879f6aae9abd8fad" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">是一个通用的错误码，表示请求报文有错误，但具体是数据格式错误、缺少请求头还是 URI 超长它没有明确说，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">只是一个笼统的错误</strong></span><span class="SemanticString">，客户端看到 400 只会是“一头雾水”“不知所措”。所以，在开发 Web 应用时应当尽量避免给客户端返回 400，而是要用其他更有明确含义的状态码。</span></span></p></div></div></details><details id="https://www.notion.so/675b61bf63ca4513964e066c03282809" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“403 Forbidden”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/39f07eaa38c64c5dbc833712de34b181" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">实际上不是客户端的请求出错，而是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">表示服务器禁止访问资源</strong></span><span class="SemanticString">。原因可能多种多样，例如信息敏感、法律禁止等，如果服务器友好一点，可以在 body 里详细说明拒绝请求的原因，不过现实中通常都是直接给一个“闭门羹”。</span></span></p></div></div></details><details id="https://www.notion.so/c3fb56d42b5747f09a24827e4747e5b3" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“404 Not Found”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/2c972d1ec57c432b9c4b3b2433cd7a05" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">它的原意是资源在本服务器上未找到，所以无法提供给客户端。但现在已经被“用滥了”，只要服务器“不高兴”就可以给出个 404，而我们也无从得知后面到底是真的未找到，还是有什么别的原因，某种程度上它比 403 还要令人讨厌。</span></span></p></div></div></details><details id="https://www.notion.so/8183623f3c7441bd8311365b9dc5796c" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">其他 4 x x</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/f6fcb5a03ec24832b9e253efdf5f7a43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">405 Method Not Allowed：不允许使用某些方法操作资源，例如不允许 POST 只能 GET；</span></span></p></div><div id="https://www.notion.so/2eb578f4181e40db9c11e2db06d611bf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">406 Not Acceptable：资源无法满足客户端请求的条件，例如请求中文但只有英文；</span></span></p></div><div id="https://www.notion.so/d5b6177a18e1491799f360df545be8de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">408 Request Timeout：请求超时，服务器等待了过长的时间；</span></span></p></div><div id="https://www.notion.so/012576ee613e476da8235580fe770cbb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">409 Conflict：多个请求发生了冲突，可以理解为多线程并发时的竞态；</span></span></p></div><div id="https://www.notion.so/b697a8748fc14cb2b825ad8173079707" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">413 Request Entity Too Large：请求报文里的 body 太大；</span></span></p></div><div id="https://www.notion.so/f2e6c129a82e4bde948ace998436b3df" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">414 Request-URI Too Long：请求行里的 URI 太大；</span></span></p></div><div id="https://www.notion.so/83917d3d81084f3a9ed417b50d027322" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">429 Too Many Requests：客户端发送了太多的请求，通常是由于服务器的限连策略；</span></span></p></div><div id="https://www.notion.so/0da27b15a4d04be1ac296b09c1641493" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">431 Request Header Fields Too Large：请求头某个字段或总体太大；</span></span></p></div></div></details><div id="https://www.notion.so/de2c7ef7c99b497a9f28ac6fd3a21645" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">5 x x</strong></span><span class="SemanticString">：5××类状态码表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端请求报文正确，但服务器在处理时内部发生了错误，无法返回应有的响应数据</strong></span><span class="SemanticString">，是服务器端的“错误码”。</span></span></p></div><details id="https://www.notion.so/a2063251f43b422da3f2a7cc449e83c8" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“500 Internal Server Error”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/c86b6309aceb4e62a775dced2bf950e0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">与 400 类似，也是一个通用的错误码，服务器究竟发生了什么错误我们是不知道的。不过</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">对于服务器来说这应该算是好事</strong></span><span class="SemanticString">，通常不应该把服务器内部的详细信息，例如出错的函数调用栈告诉外界。虽然不利于调试，但能够防止黑客的窥探或者分析。</span></span></p></div></div></details><details id="https://www.notion.so/0fd716df2cc64f1c817e8877f37223a3" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“501 Not Implemented”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/3287b5328fc34fe796d24a33d9a28e15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端请求的功能还不支持</strong></span><span class="SemanticString">，这个错误码比 500 要“温和”一些，和“即将开业，敬请期待”的意思差不多，不过具体什么时候“开业”就不好说了。</span></span></p></div></div></details><details id="https://www.notion.so/7ce3a09cdd60435d90bdb6d5cf8e5be8" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“502 Bad Gateway”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/9e59aa389bb8430bacd441b255b7248d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通常是服务器</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">作为网关或者代理</strong></span><span class="SemanticString">时返回的错误码，表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器自身工作正常，访问后端服务器时发生了错误</strong></span><span class="SemanticString">，但具体的错误原因也是不知道的。</span></span></p></div></div></details><details id="https://www.notion.so/2bb0af6305764a7db2efa1cb0ba617d7" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">“503 Service Unavailable”</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/30f52b4088f048d991c958e776b73af8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">表示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器当前很忙，暂时无法响应服务</strong></span><span class="SemanticString">，我们上网时有时候遇到的“网络服务正忙，请稍后重试”的提示信息就是状态码 503。503 是一个“临时”的状态，很可能过几秒钟后服务器就不那么忙了，可以继续提供服务，所以 503 响应报文里通常还会有一个“Retry-After”字段，指示</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端可以在多久以后再次尝试发送请求</strong></span><span class="SemanticString">。</span></span></p></div></div></details><div id="https://www.notion.so/04289cbc5a604ab6971433e542388b3a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Web 服务的常见做法：因为http状态码很有限，而且含义不是很清楚，所以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通常需要在body里返回额外的数据来说明更详细的错误原因</strong></span><span class="SemanticString">，常用的就是json了。</span></span></p></div><div id="https://www.notion.so/a925f0480a4a48a4b5a6eda86f3d3f4a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">就目前项目开发的过程中，状态码的使用对业务程序来说，基本上很少去利用，大致都是nginx、tomcat、spring等这些框架、中间件会返回一些状态码，例如接口不存在，框架会返回404，nginx配置有问题或者拒绝访问返回403或者502等状态码，一旦正确进入业务接口的时候</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">，不管请求的用户id是否在用户库中存在、以及请求参数中是否缺少必要参数，都是返回200状态码，只是在body的json里面会返回自己特有的业务错误码</strong></span><span class="SemanticString">，例如: {&quot;code&quot;:-1,&quot;message:&quot;userid参数必须填写&quot;}。</span></span></p></div><h3 id="https://www.notion.so/632e4304992240a68be4c7cc93036ce6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/632e4304992240a68be4c7cc93036ce6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP协议特点</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/065ebb5439c14454bd1c74b900aef954" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">HTTP 是灵活可扩展的，可以任意添加头字段实现任意功能；</span></span></li><li id="https://www.notion.so/37687bccafb9424cb8536b4195c6f8c9" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">HTTP 是可靠传输协议，基于 TCP/IP 协议“尽量”保证数据的送达；</span></span></li><li id="https://www.notion.so/f487511664c3417c88df39921c7ab30f" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">HTTP 是应用层协议，比 FTP、SSH 等更通用功能更多，能够传输任意数据；（在 TCP/IP 诞生后的几十年里，虽然出现了许多的应用层协议，但它们都仅关注很小的应用领域，局限在很少的应用场景。例如 FTP 只能传输文件、SMTP 只能发送邮件、SSH 只能远程登录等，在通用的数据传输方面“完全不能打”。）</span></span></li><li id="https://www.notion.so/f08bb22667f24d7ba491a5295864e9af" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">HTTP 使用了请求 - 应答模式，客户端主动发起请求，服务器被动回复请求；（HTTP 的请求 - 应答模式也恰好契合了传统的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> C/S（Client/Server）</strong></span><span class="SemanticString">系统架构，请求方作为客户端、应答方作为服务器。所以，随着互联网的发展就出现了 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">B/S（Browser/Server）</strong></span><span class="SemanticString">架构，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用轻量级的浏览器代替笨重的客户端应用</strong></span><span class="SemanticString">，实现零维护的“瘦”客户端，而服务器则摈弃私有通信协议转而使用 HTTP 协议。此外，请求 - 应答模式也完全符合 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">RPC（Remote Procedure Call）</strong></span><span class="SemanticString">的工作模式，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">可以把 HTTP 请求处理封装成远程函数调用</strong></span><span class="SemanticString">，导致了 WebService、RESTful 和 gRPC 等的出现。）</span></span></li><li id="https://www.notion.so/cc0f328fac34495bb064f0d8d69d76f5" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString">HTTP 本质上是无状态的，每个请求都是互相独立、毫无关联的，协议不要求客户端或服务器记录请求相关的信息。（“状态”其实就是客户端或者服务器里保存的一些数据或者标志，记录了通信过程中的一些变化信息。你一定知道，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">TCP 协议是有状态的</strong></span><span class="SemanticString">，一开始处于 CLOSED 状态，连接成功后是 ESTABLISHED 状态，断开连接后是 FIN-WAIT 状态，最后又是 CLOSED 状态。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">这些“状态”就需要 TCP 在内部用一些数据结构去维护，可以简单地想象成是个标志量，标记当前所处的状态</strong></span><span class="SemanticString">，例如 0 是 CLOSED，2 是 ESTABLISHED 等等。我们可以再对比一下 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">UDP 协议，不过它是无连接也无状态的，顺序发包乱序收包</strong></span><span class="SemanticString">，数据包发出去后就不管了，收到后也不会顺序整理。而 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP 是有连接无状态，顺序发包顺序收包</strong></span><span class="SemanticString">，按照收发的顺序管理报文。）</span></span></li><li id="https://www.notion.so/7c113736965a427db1f1f57d77b33c02" class="NumberedList" value="6"><span class="SemanticStringArray"><span class="SemanticString">应用广泛、环境成熟，即跨语言、跨平台。</span></span></li><li id="https://www.notion.so/521acfe0c36d4c16a70c3cf2e6bf0079" class="NumberedList" value="7"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">明文传输</strong></span><span class="SemanticString">。在漫长的传输链路的每一个环节上都毫无隐私可言，不怀好意的人只要侵入了这个链路里的某个设备，简单地“旁路”一下流量，就可以实现对通信的窥视。“免费 WiFi 陷阱”：黑客就是利用了 HTTP 明文传输的缺点，在公共场所架设一个 WiFi 热点开始“钓鱼”，诱骗网民上网。一旦你连上了这个 WiFi 热点，所有的流量都会被截获保存，里面如果有银行卡号、网站密码等敏感信息的话那就危险了，黑客拿到了这些数据就可以冒充你为所欲为。</span></span></li><li id="https://www.notion.so/6454f3b875dc408c852dbdd05e2dfd64" class="NumberedList" value="8"><span class="SemanticStringArray"><span class="SemanticString">不安全。有很多的方面，明文只是“机密”方面的一个缺点，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">在“身份认证”和“完整性校验”这两方面 HTTP 也是欠缺的</strong></span><span class="SemanticString">。为了解决 HTTP 不安全的缺点，所以就出现了 HTTPS。</span></span></li><li id="https://www.notion.so/dd3a7f40395048bd910bf8c31954d596" class="NumberedList" value="9"><span class="SemanticStringArray"><span class="SemanticString">性能问题。“请求 - 应答”模式则加剧了 HTTP 的性能问题，这就是著名的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“队头阻塞”（Head-of-line blocking）</strong></span><span class="SemanticString">，当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一并被阻塞，会导致客户端迟迟收不到数据。为了解决这个问题，就诞生出了一个专门的研究课题</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“Web 性能优化”</strong></span><span class="SemanticString">，HTTP 官方标准里就有“缓存”一章（RFC7234），非官方的“花招”就更多了，例如切图、数据内嵌与合并，域名分片、JavaScript“黑科技”等等。不过现在已经有了终极解决方案：HTTP/2 和 HTTP/3。</span></span></li></ol><h2 id="https://www.notion.so/7765ab1595b6452ebf15b0e34647930e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7765ab1595b6452ebf15b0e34647930e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">进阶篇</span></span></h2><h3 id="https://www.notion.so/0403d23bca244c31ad2887917d2343fd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/0403d23bca244c31ad2887917d2343fd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP的实体数据</span></span></h3><div id="https://www.notion.so/211a56ae672748b4a104dd4187ab4427" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">引入原因：在前面的“基础篇”里我们了解了 HTTP 报文的结构，知道一个 HTTP 报文是由“header+body”组成的。但那时我们主要研究的是 header，没有涉及到 body。所以，“进阶篇”的第一讲就从 HTTP 的 body 谈起。</span></span></p></div><div id="https://www.notion.so/a00448e57e5a4ed28fa26e38e6500742" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据类型、编码与其使用的头字段</strong></span></span></p></div><div id="https://www.notion.so/86b7ac1c67f94cc68c6b1ff07122563b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TCP、UDP与HTTP协议的区别：TCP、UDP 因为是传输层的协议，它们</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">不会关心 body 数据是什么</strong></span><span class="SemanticString">，只要把数据发送到对方就算是完成了任务。而 HTTP 协议则不同，它是应用层的协议，数据到达之后工作只能说是完成了一半，还</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">必须要告诉上层应用这是什么数据</strong></span><span class="SemanticString">才行，否则上层应用就会“不知所措”。</span></span></p></div><div id="https://www.notion.so/72863d749257457896310ea7f1256a73" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如何得知数据类型的解决方案</strong></span><span class="SemanticString">：早在 HTTP 协议诞生之前就已经有了针对这种问题的解决方案，不过它是用在电子邮件系统里的，让电子邮件可以发送 ASCII 码以外的任意数据，方案的名字叫做</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“多用途互联网邮件扩展”（Multipurpose Internet Mail Extensions），简称为 MIME</strong></span><span class="SemanticString">。MIME 是一个很大的标准规范，但 HTTP 只“顺手牵羊”取了其中的一部分，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用来标记 body 的数据类型</strong></span><span class="SemanticString">，这就是我们平常总能听到的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“MIME type”</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/79c20c77cd9a4375a60504a7d035338c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">MIME 数据分类</strong></span><span class="SemanticString">：MIME 把数据分成了八大类，每个大类下再细分出多个子类，形式是“type/subtype”的字符串，常用的如下：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/8ebd354ec80e4572843bdab902ed9a58" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">text</strong></span><span class="SemanticString">：即文本格式的可读数据，我们最熟悉的应该就是 text/html 了，表示超文本文档，此外还有纯文本 text/plain、样式表 text/css 等。</span></span></li><li id="https://www.notion.so/0cf9661fcdcf41a994a8bd3779de48de" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">image</strong></span><span class="SemanticString">：即图像文件，有 image/gif、image/jpeg、image/png 等。</span></span></li><li id="https://www.notion.so/b6a131747d784ee1b9d2de7fb1513951" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">audio/video</strong></span><span class="SemanticString">：音频和视频数据，例如 audio/mpeg、video/mp4 等。</span></span></li><li id="https://www.notion.so/ac1d9b89be9c4eebb654ed9084feb6ec" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">application</strong></span><span class="SemanticString">：数据格式不固定，可能是文本也可能是二进制，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">必须由上层应用程序来解释</strong></span><span class="SemanticString">。常见的有 application/json，application/javascript、application/pdf 等，另外，如果实在是不知道数据是什么类型，像刚才说的“黑盒”，就会是 application/octet-stream，即不透明的二进制数据。</span></span></li></ol><div id="https://www.notion.so/f2c9ecb67cb24e7f9840f3fe5d273a9d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如何节约带宽的解决方案</strong></span><span class="SemanticString">：但仅有 MIME type 还不够，因为 HTTP 在传输时为了节约带宽，有时候还会</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">压缩数据</strong></span><span class="SemanticString">，为了不要让浏览器继续“猜”，还需要有一个</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“Encoding type”</strong></span><span class="SemanticString">，告诉数据是用的什么编码格式，这样</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">对方才能正确解压缩</strong></span><span class="SemanticString">，还原出原始的数据。</span></span></p></div><div id="https://www.notion.so/f3bee82f07c64708806d8758446bc7d1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">编码格式分类</strong></span><span class="SemanticString">：Encoding type 就少了很多，常用的只有下面三种：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/a6bf60333ae941609b0a54c3bfe7f485" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">gzip</strong></span><span class="SemanticString">：GNU zip 压缩格式，也是互联网上最流行的压缩格式；</span></span></li><li id="https://www.notion.so/be7b3e3dccd2414d941f1f63be392879" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">deflate</strong></span><span class="SemanticString">：zlib（deflate）压缩格式，流行程度仅次于 gzip；</span></span></li><li id="https://www.notion.so/0cf9ce17917941c6ae4aa03347485e73" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">br</strong></span><span class="SemanticString">：一种专门为 HTTP 优化的新压缩算法（Brotli）。</span></span></li></ol><div id="https://www.notion.so/8b0f84a69f7643af8791f17d59f3d261" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据类型使用的头字段</strong></span><span class="SemanticString">：HTTP 协议为此定义了两个 Accept 请求头字段和两个 Content 实体头字段，用于客户端和服务器进行“内容协商”。也就是说，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">客户端用 Accept 头</strong></span><span class="SemanticString">告诉服务器希望接收什么样的数据，而</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器用 Content 头</strong></span><span class="SemanticString">告诉客户端实际发送了什么样的数据。</span></span></p></div><div id="https://www.notion.so/6d04a57cf7f843369e9a04e64c369e54" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F990ecb0e-4d7b-41d4-a016-78053a157aec%2FUntitled.png?width=576&amp;table=block&amp;id=6d04a57c-f7f8-4336-9e9a-04e64c369e54"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F990ecb0e-4d7b-41d4-a016-78053a157aec%2FUntitled.png?width=576&amp;table=block&amp;id=6d04a57c-f7f8-4336-9e9a-04e64c369e54" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/9253a1c3f93346ab880cce25febf21c6" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Accept </strong></span><span class="SemanticString">字段标记的是客户端可理解的 MIME type，可以用“,”做分隔符列出多个类型，让服务器有更多的选择余地： </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Accept: text/html,application/xml,image/webp,image/png</code></span><span class="SemanticString"> </span></span></li><li id="https://www.notion.so/355e52a7a3e64e7eb73602746331a9a6" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">相应的，服务器会在响应报文里用头字段</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> Content-Type </strong></span><span class="SemanticString">告诉实体数据的真实类型：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Content-Type: text/html</code></span></span></li><li id="https://www.notion.so/dc640f0524a14fe492787b99526046b9" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Accept-Encoding</strong></span><span class="SemanticString"> 字段标记的是客户端支持的压缩格式，例如上面说的 gzip、deflate 等，同样也可以用“,”列出多个，服务器可以选择其中一种来压缩数据，实际使用的压缩格式放在响应头字段 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Content-Encoding</strong></span><span class="SemanticString"> 里。注意：不过</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">这两个字段是可以省略的</strong></span><span class="SemanticString">，如果请求报文里没有 Accept-Encoding 字段，就表示客户端不支持压缩数据；如果响应报文里没有 Content-Encoding 字段，就表示响应数据没有被压缩。</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Accept-Encoding: gzip, deflate, br</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Content-Encoding: gzip</code></span><span class="SemanticString"> </span></span></li></ol><div id="https://www.notion.so/bb182892f614477c85154e33427954a6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">语言类型、编码与其使用的头字段</strong></span></span></p></div><div id="https://www.notion.so/9cadaa7ff3f44e6c8d2f042ceb8b931a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">语言类型</strong></span><span class="SemanticString">：就是人类使用的自然语言，例如英语、汉语、日语等，而这些自然语言可能还有下属的地区性方言，所以在需要明确区分的时候也要使用“type-subtype”的形式，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">不过这里的格式与数据类型不同，分隔符不是“/”，而是“-”</strong></span><span class="SemanticString">。如：en 表示任意的英语，en-US 表示美式英语，en-GB 表示英式英语，而 zh-CN 就表示我们最常使用的汉语。</span></span></p></div><div id="https://www.notion.so/c8612b67bf3b47baa54529adc9a74ca9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">编码与字符集</strong></span><span class="SemanticString">：遵循 UTF-8 字符编码方式的 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Unicode 字符集</strong></span><span class="SemanticString">也成为了互联网上的标准字符集。</span></span></p></div><div id="https://www.notion.so/470c30a6eaf94bbf99ab545f1a6bc0c6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">语言类型使用的头字段</strong></span><span class="SemanticString">：HTTP 协议也使用 Accept 请求头字段和 Content 实体头字段，用于客户端和服务器就语言与编码进行“内容协商”。</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/05018a50d3d949c59fdb31611ed86de3" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Accept-Language</strong></span><span class="SemanticString"> 字段标记了客户端可理解的自然语言，也允许用“,”做分隔符列出多个类型（从前到后是优先级排列）：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Accept-Language: zh-CN, zh, en</code></span><span class="SemanticString"> </span></span></li><li id="https://www.notion.so/41951ef7caf64f9a916fe21645b37726" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">相应的，服务器应该在响应报文里用头字段 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Content-Language</strong></span><span class="SemanticString"> 告诉客户端实体数据使用的实际语言类型：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Content-Language: zh-CN</code></span><span class="SemanticString"> </span></span></li><li id="https://www.notion.so/13dc18b01bd84e30906ffbc17ae69e09" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">字符集在 HTTP 里使用的请求头字段是 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Accept-Charset</strong></span><span class="SemanticString">，但响应头里却</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">没有</strong></span><span class="SemanticString">对应的 Content-Charset，而是在 Content-Type 字段的数据类型后面用“charset=xxx”来表示，这点需要特别注意。</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Accept-Charset: gbk, utf-8</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Content-Type: text/html; charset=utf-8</code></span></span><div id="https://www.notion.so/c2417f9fe5e644e6b934e56117a0afdf" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F75908297-2147-4158-8ec8-41e3cb3ad079%2FUntitled.png?width=624&amp;table=block&amp;id=c2417f9f-e5e6-44e6-b934-e56117a0afdf"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F75908297-2147-4158-8ec8-41e3cb3ad079%2FUntitled.png?width=624&amp;table=block&amp;id=c2417f9f-e5e6-44e6-b934-e56117a0afdf" style="width:624px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li></ol><div id="https://www.notion.so/1c98067cefa843cc97654cd83a8271fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注意：不过现在的浏览器都支持多种字符集，通常不会发送 Accept-Charset，而服务器也不会发送 Content-Language，因为使用的语言完全可以由字符集推断出来，所以</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">在请求头里一般只会有 Accept-Language 字段，响应头里只会有 Content-Type 字段</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/5d6834b6586c44ce96c124ba46a509dc" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe03ee08f-b017-4ff8-badc-1867d7f98f67%2FUntitled.png?width=576&amp;table=block&amp;id=5d6834b6-586c-44ce-96c1-24ba46a509dc"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe03ee08f-b017-4ff8-badc-1867d7f98f67%2FUntitled.png?width=576&amp;table=block&amp;id=5d6834b6-586c-44ce-96c1-24ba46a509dc" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f6bb39db4e854312802e9a827fed5077" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">内容协商：q参数与优先级，服务器Vary字段（版本标记）</strong></span></span></p></div><div id="https://www.notion.so/436bdd6fda87424ca030de31dcaefeb5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">q参数与优先级</strong></span><span class="SemanticString">：在 HTTP 协议里用 Accept、Accept-Encoding、Accept-Language 等请求头字段进行内容协商的时候，还可以用一种特殊的“q”参数表示权重来设定优先级，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">这里的“q”是“quality factor”的意思</strong></span><span class="SemanticString">。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">权重的最大值是 1，最小值是 0.01，默认值是 1，如果值是 0 就表示拒绝</strong></span><span class="SemanticString">。具体的形式是在数据类型或语言代码后面加一个“;”，然后是“q=value”。这里要提醒的是“;”的用法，在大多数编程语言里“;”的断句语气要强于“,”，而在 HTTP 的内容协商里却恰好反了过来，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“;”的意义是小于“,”</strong></span><span class="SemanticString">的。</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Accept: text/html,application/xml;q=0.9,</code></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">/</em></code></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">;q=0.8</code></span><span class="SemanticString"> </span></span></p></div><div id="https://www.notion.so/85c7dfb702bc4635a60de06ac3557f55" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">内容协商的结果</strong></span><span class="SemanticString">：内容协商的过程是不透明的，每个 Web 服务器使用的算法都不一样。但有的时候，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器会在响应头里多加一个 Vary 字段，记录服务器在内容协商时参考的请求头字段</strong></span><span class="SemanticString">，给出一点信息，例如：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Vary: Accept-Encoding,User-Agent,Accept</code></span><span class="SemanticString"> 这个 Vary 字段表示服务器依据了 Accept-Encoding、User-Agent 和 Accept 这三个头字段，然后决定了发回的响应报文。Vary 字段可以认为是响应报文的一个</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">特殊的“版本标记”</strong></span><span class="SemanticString">。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">每当 Accept 等请求头变化时，Vary 也会随着响应报文一起变化</strong></span><span class="SemanticString">。也就是说，同一个 URI 可能会有多个不同的“版本”，主要用在传输链路中间的代理服务器实现缓存服务，这个之后讲“HTTP 缓存”时还会再提到。</span></span></p></div><h3 id="https://www.notion.so/b65d89f335ad49daacdd8262cb5e72ca" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b65d89f335ad49daacdd8262cb5e72ca"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP传输大文件的方法：数据压缩、分块传输、范围请求、多段数据</span></span></h3><div id="https://www.notion.so/2b5e77b21458450781d6235a5e5c27da" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">问题：早期互联网上传输的基本上都是只有几 K 大小的文本和小图片，现在的情况则大有不同。网页里包含的信息实在是太多了，随随便便一个主页 HTML 就有可能上百 K，高质量的图片都以 M 论，更不要说那些电影、电视剧了，几 G、几十 G 都有可能。</span></span></p></div><div id="https://www.notion.so/a968aa821a7d43ff9cf85e760a369ed3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据压缩</strong></span></span></p></div><div id="https://www.notion.so/95b3f25b71054aa49d5a2436a410589e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通常</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">浏览器在发送请求时都会带着“Accept-Encoding”头字段</strong></span><span class="SemanticString">，里面是浏览器支持的压缩格式列表，例如 gzip、deflate、br 等，这样</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器</strong></span><span class="SemanticString">就可以从中</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">选择一种压缩算法，放进“Content-Encoding”响应头里</strong></span><span class="SemanticString">，再把原数据压缩后发给浏览器。</span></span></p></div><div id="https://www.notion.so/79788bc9796b403390afc4bf10df31c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">不过这个解决方法也有个缺点，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">gzip 等压缩算法通常只对文本文件有较好的压缩率，而图片、音频视频等多媒体数据本身就已经是高度压缩的，再用 gzip 处理也不会变小</strong></span><span class="SemanticString">（甚至还有可能会增大一点），所以它就失效了。不过数据压缩在处理文本的时候效果还是很好的，所以各大网站的服务器都会使用这个手段作为“保底”。例如，在 Nginx 里就会使用“gzip on”指令，启用对“text/html”的压缩，很智能，不会压缩图片、音频、视频。</span></span></p></div><div id="https://www.notion.so/70a44d59d1924a9fbf5e4b5e6d71fdef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">分块传输</strong></span></span></p></div><div id="https://www.notion.so/aa04b0ad09224f199deaa54b2ac2d7fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果大文件整体不能变小，那就把它“拆开”，分解成多个小块，把这些小块分批发给浏览器，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">浏览器收到后再组装复原</strong></span><span class="SemanticString">。这样浏览器和服务器都不用在内存里保存文件的全部，每次只收发一小部分，网络也不会被大文件长时间占用，内存、带宽等资源也就节省下来了。这种“化整为零”的思路在 HTTP 协议里就是“chunked”分块传输编码，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">在响应报文里用头字段“Transfer-Encoding: chunked”来表示</strong></span><span class="SemanticString">，意思是报文里的 body 部分不是一次性发过来的，而是分成了许多的块（chunk）逐个发送。</span></span></p></div><div id="https://www.notion.so/c7eb3f613d3e4751b522eb48089ac8ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">分块传输也可以用于</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“流式数据”</strong></span><span class="SemanticString">，例如由数据库动态生成的表单页面，这种情况下 body 数据的长度是未知的，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">无法在头字段“Content-Length”里给出确切的长度</strong></span><span class="SemanticString">，所以也只能用 chunked 方式分块发送。</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“Transfer-Encoding: chunked”和“Content-Length”这两个字段是互斥的</strong></span><span class="SemanticString">，也就是说响应报文里这两个字段不能同时出现，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">一个响应报文的传输要么是长度已知，要么是长度未知（chunked）</strong></span><span class="SemanticString">，这一点你一定要记住。</span></span></p></div><div id="https://www.notion.so/a53b462a1e9c4f69af86728e329aae45" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">下面我们来看一下分块传输的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">编码规则</strong></span><span class="SemanticString">，其实也很简单，同样采用了明文的方式，很类似响应头。</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/72aca550f468419fbde755918383adb1" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">每个分块包含两个部分，长度头和数据块；</span></span></li><li id="https://www.notion.so/77c3398915ad44e5b8d6d94c631ec0eb" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">长度头是以 CRLF（回车换行，即\r\n）结尾的一行明文，用 16 进制数字表示长度；</span></span></li><li id="https://www.notion.so/ca77b7bae4a948b0b2e63fd5f5941efd" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">数据块紧跟在长度头后，最后也用 CRLF 结尾，但数据不包含 CRLF；</span></span></li><li id="https://www.notion.so/47d63df8d0794b9e8bc7be865ecbb162" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">最后用一个长度为 0 的块表示结束，即“0\r\n\r\n”。</span></span></li></ol><div id="https://www.notion.so/fc4041797b724935ae3a4070483c2675" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffc6976c3-7ec2-4801-96c2-e0dd189cc06e%2FUntitled.png?width=576&amp;table=block&amp;id=fc404179-7b72-4935-ae3a-4070483c2675"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffc6976c3-7ec2-4801-96c2-e0dd189cc06e%2FUntitled.png?width=576&amp;table=block&amp;id=fc404179-7b72-4935-ae3a-4070483c2675" style="width:576px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2d7074380cf5432cbf64efe6f3a65e15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">分块传输数据的时候，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如果数据里含有回车换行（\r\n）是否会影响分块的处理呢</strong></span><span class="SemanticString">？分块传输中数据里含有回车换行（\r\n）不影响分块处理，因为</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">分块前有数据长度说明</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/554845a66fa24e528a7387aa6a43b385" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">范围请求</strong></span></span></p></div><div id="https://www.notion.so/122277dade5940b0b96dacab1fd47620" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">有了分块传输编码，服务器就可以轻松地收发大文件了，但对于上 G 的超大文件，还有一些问题需要考虑。比如，你在看当下正热播的某穿越剧，想跳过片头，直接看正片，或者有段剧情很无聊，想拖动进度条快进几分钟，这实际上是想获取一个大文件其中的片段数据，而分块传输并没有这个能力。</span></span></p></div><div id="https://www.notion.so/d2392db8fdac432cb0204f5a219b8d52" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP 协议为了满足这样的需求，提出了</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“范围请求”（range requests）</strong></span><span class="SemanticString">的概念，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">允许客户端在请求头里使用专用字段来表示只获取文件的一部分</strong></span><span class="SemanticString">，相当于是客户端的“化整为零”。范围请求不是 Web 服务器必备的功能，可以实现也可以不实现，所以服务器必须在响应头里使用字段</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“Accept-Ranges: bytes”</strong></span><span class="SemanticString">明确告知客户端：“我是支持范围请求的”。如果不支持的话该怎么办呢？</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器可以发送“Accept-Ranges: none”，或者干脆不发送“Accept-Ranges”字段</strong></span><span class="SemanticString">，这样客户端就认为服务器没有实现范围请求功能，只能老老实实地收发整块文件了。</span></span></p></div><div id="https://www.notion.so/81588fc8d87f483ebd05081d3e7032c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">请求头 Range 是 HTTP 范围请求的专用字段，格式是“bytes=x-y”</strong></span><span class="SemanticString">，其中的 x 和 y 是以字节为单位的数据范围。要注意</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> x、y 表示的是“偏移量”，范围必须从 0 计数</strong></span><span class="SemanticString">，例如前 10 个字节表示为“0-9”，第二个 10 字节表示为“10-19”，而“0-10”实际上是前 11 个字节。Range 的格式也很灵活，起点 x 和终点 y 可以省略，能够很方便地表示正数或者倒数的范围。假设文件是 100 个字节，那么：“0-”表示从文档起点到文档终点，相当于“0-99”，即整个文件；“10-”是从第 10 个字节开始到文档末尾，相当于“10-99”；“-1”是文档的最后一个字节，相当于“99-99”；“-10”是从文档末尾倒数 10 个字节，相当于“90-99”。</span></span></p></div><div id="https://www.notion.so/cb04036591ec4dfb9bf7d685ba37dec0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">服务器收到 Range 字段后，需要做哪四件事？</strong></span><span class="SemanticString">1）它必须检查范围是否合法，比如文件只有 100 个字节，但请求“200-300”，这就是范围越界了。服务器就会返回状态码</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> 416，意思是“你的范围请求有误，我无法处理，请再检查一下</strong></span><span class="SemanticString">”。2）如果范围正确，服务器就可以根据 Range 头计算偏移量，读取文件的片段了，返回状态码</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“206 Partial Content”</strong></span><span class="SemanticString">，和 200 的意思差不多，但表示 body 只是原数据的一部分。3）服务器要添加一个响应头字段 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Content-Range</strong></span><span class="SemanticString">，告诉片段的实际偏移量和资源的总大小，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">格式是“bytes x-y/length”，与 Range 头区别在没有“=”，范围后多了总长度</strong></span><span class="SemanticString">。例如，对于“0-10”的范围请求，值就是“bytes 0-10/100”。4）剩下的就是发送数据了，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">直接把片段用 TCP 发给客户端</strong></span><span class="SemanticString">，一个范围请求就算是处理完了。</span></span></p></div><pre id="https://www.notion.so/4b7e51fe1b55480bbc40d85d74045e01" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// 客户端
GET /16-2 HTTP/1.1
Host: www.chrono.com
Range: bytes=0-31

// 服务器
HTTP/1.1 206 Partial Content
Content-Length: 32
Accept-Ranges: bytes
Content-Range: bytes 0-31/96

// this is a plain text json doc</span></span></span></code></pre><div id="https://www.notion.so/d61f07245a89438ca5ff4e6fd5cc4f42" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">有了范围请求之后，HTTP 处理大文件就更加轻松了，看视频时可以根据时间点计算出文件的 Range，不用下载整个文件，直接精确获取片段所在的数据内容。不仅看视频的拖拽进度需要范围请求，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">常用的下载工具里的多段下载、断点续传</strong></span><span class="SemanticString">也是基于它实现的，要点是：1）先发个 HEAD，看服务器是否支持范围请求，同时获取文件的大小；2）开 N 个线程，每个线程使用 Range 字段划分出各自负责下载的片段，发请求传输数据；3）下载意外中断也不怕，不必重头再来一遍，只要根据上次的下载记录，用 Range 请求剩下的那一部分就可以了。</span></span></p></div><div id="https://www.notion.so/683eea1a470049dd9ba94525cf623db0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">多段数据</strong></span></span></p></div><div id="https://www.notion.so/c7b1033f8ff847f98215796a1e9e7112" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">刚才说的范围请求一次只获取一个片段，其实它还</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">支持在 Range 头里使用多个“x-y”，一次性获取多个片段数据</strong></span><span class="SemanticString">。这种情况需要使用一种特殊的 MIME 类型：</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">“multipart/byteranges”</strong></span><span class="SemanticString">，表示报文的 body 是由多段字节序列组成的，并且还要用一个参数“boundary=xxx”给出段之间的分隔标记。多段数据的格式与分块传输也比较类似，但它需要用分隔标记 boundary 来区分不同的片段，可以通过图来对比一下。</span></span></p></div><div id="https://www.notion.so/0a0f333e768c43b9a6a20c6775923d2d" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd4d14751-0c81-4343-8f24-66703a3b1b73%2FUntitled.png?width=3000&amp;table=block&amp;id=0a0f333e-768c-43b9-a6a2-0c6775923d2d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd4d14751-0c81-4343-8f24-66703a3b1b73%2FUntitled.png?width=3000&amp;table=block&amp;id=0a0f333e-768c-43b9-a6a2-0c6775923d2d" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/ed9b71b0a15141ec9d8d0a35d2b8dd5d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// 客户端
GET /16-2 HTTP/1.1
Host: www.chrono.com
Range: bytes=0-9, 20-29

// 服务器
HTTP/1.1 206 Partial Content
Content-Type: multipart/byteranges; boundary=00000000001
Content-Length: 189
Connection: keep-alive
Accept-Ranges: bytes


--00000000001
Content-Type: text/plain
Content-Range: bytes 0-9/96

// this is
--00000000001
Content-Type: text/plain
Content-Range: bytes 20-29/96

ext json d
--00000000001--</span></span></span></code></pre><div id="https://www.notion.so/ecbe3a6beafa4f5b9df1fcd050714da5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如果对一个被 gzip 的文件执行范围请求，比如“Range: bytes=10-19”，那么这个范围是应用于原文件还是压缩后的文件呢</strong></span><span class="SemanticString">？需要分情况，看原文件是什么形式。如果原来的文件是gzip的，那就正确。如果原文件是文本，而是在传输过程中被压缩，那么就应用于压缩前的数据。 总之是</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">范围是针对原数据</strong></span><span class="SemanticString">。</span></span></p></div><h3 id="https://www.notion.so/30084e6109eb4c59a7261c0bc5ebc91a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/30084e6109eb4c59a7261c0bc5ebc91a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></h3><div id="https://www.notion.so/f96d7df509a14f17b94d055076a2afeb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">短连接</span></span></p></div><h3 id="https://www.notion.so/b763d256406748e4be5fffd025898cba" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b763d256406748e4be5fffd025898cba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></h3><h3 id="https://www.notion.so/534225758bc542f19bd3986c6f1f7af6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/534225758bc542f19bd3986c6f1f7af6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></h3><h3 id="https://www.notion.so/9e8e19b7306d49658f4d2ad9fa07b255" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/9e8e19b7306d49658f4d2ad9fa07b255"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HTTP的连接管理</strong></strong></span></span></h3><div id="https://www.notion.so/8a1b5173b405468eba8ab4c187057e6d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/32ca53661a7d4e4e9d8c00b3027122ce" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/32ca53661a7d4e4e9d8c00b3027122ce"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">安全篇</span></span></h2><h2 id="https://www.notion.so/719ed1792b01499ab1a5e94741beb74d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/719ed1792b01499ab1a5e94741beb74d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">飞翔篇</span></span></h2><h2 id="https://www.notion.so/71e5a614b5854751898565d87c248d17" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/71e5a614b5854751898565d87c248d17"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">探索篇</span></span></h2><h2 id="https://www.notion.so/e7c2a93ae9c541f6856b27fe754e5ae6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e7c2a93ae9c541f6856b27fe754e5ae6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">其他</span></span></h2><div id="https://www.notion.so/5162ba6e5cc441378871ca4e080cee9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/e677dd73ae3e4ad0bc63062f57a923f6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/7b2ea6db30be4d55a6c6ba06db0bf276" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7b2ea6db30be4d55a6c6ba06db0bf276"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">思维导图</span></span></h2><div id="https://www.notion.so/5a486b6c5fce41e9989a7aeeb79a840c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">左边偏理论，右边偏实际。</span></span></p></div><div id="https://www.notion.so/72e79d8b635942c383566b6347b4b784" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbf184e91-3665-4d79-ab28-735423237b6e%2F0b1034103daef8dccc2a270051e8ba0.jpg?width=2065&amp;table=block&amp;id=72e79d8b-6359-42c3-8356-6b6347b4b784"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbf184e91-3665-4d79-ab28-735423237b6e%2F0b1034103daef8dccc2a270051e8ba0.jpg?width=2065&amp;table=block&amp;id=72e79d8b-6359-42c3-8356-6b6347b4b784" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/c2e6ff1b49a943acad2c47ec2de87afb" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fada02f3f-3249-47bc-9ecc-f124f903882c%2FUntitled.png?width=1350&amp;table=block&amp;id=c2e6ff1b-49a9-43ac-ad2c-47ec2de87afb"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fada02f3f-3249-47bc-9ecc-f124f903882c%2FUntitled.png?width=1350&amp;table=block&amp;id=c2e6ff1b-49a9-43ac-ad2c-47ec2de87afb" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>
    <aside class="Aside">
        <a href="#content-html"><div id="up">👆</div></a>
        <a href="#message-board"><div id="down">👇</div></a>
    </aside>
    <div id="message-board"></div>
    <script src="https://utteranc.es/client.js"
        repo="Iris1e27/Iris1e27.github.io"
        issue-term="pathname"
        label="✨"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
  <footer class="Footer">
  <div>&copy; Jingtian的博客 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>
